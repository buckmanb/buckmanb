"use strict";(self.webpackChunkblog_app=self.webpackChunkblog_app||[]).push([[682],{1349:(Q,S,l)=>{l.d(S,{CB:()=>O,DQ:()=>f,Q3:()=>x,qS:()=>C,sL:()=>F,xn:()=>w,y4:()=>D,zP:()=>L});var h=l(1642),j=(l(1531),l(3016),l(8447)),E=l(3107);class C{}function D(u){return u&&"function"==typeof u.connect&&!(u instanceof h.G)}var x=function(u){return u[u.REPLACED=0]="REPLACED",u[u.INSERTED=1]="INSERTED",u[u.MOVED=2]="MOVED",u[u.REMOVED=3]="REMOVED",u}(x||{});const F=new E.nKC("_ViewRepeater");class w{applyChanges(s,c,m,b,g){s.forEachOperation((p,k,I)=>{let R,T;if(null==p.previousIndex){const P=m(p,k,I);R=c.createEmbeddedView(P.templateRef,P.context,P.index),T=x.INSERTED}else null==I?(c.remove(k),T=x.REMOVED):(R=c.get(k),c.move(R,I),T=x.MOVED);g&&g({context:R?.context,operation:T,record:p})})}detach(){}}class f{viewCacheSize=20;_viewCache=[];applyChanges(s,c,m,b,g){s.forEachOperation((p,k,I)=>{let R,T;null==p.previousIndex?(R=this._insertView(()=>m(p,k,I),I,c,b(p)),T=R?x.INSERTED:x.REPLACED):null==I?(this._detachAndCacheView(k,c),T=x.REMOVED):(R=this._moveView(k,I,c,b(p)),T=x.MOVED),g&&g({context:R?.context,operation:T,record:p})})}detach(){for(const s of this._viewCache)s.destroy();this._viewCache=[]}_insertView(s,c,m,b){const g=this._insertViewFromCache(c,m);if(g)return void(g.context.$implicit=b);const p=s();return m.createEmbeddedView(p.templateRef,p.context,p.index)}_detachAndCacheView(s,c){const m=c.detach(s);this._maybeCacheView(m,c)}_moveView(s,c,m,b){const g=m.get(s);return m.move(g,c),g.context.$implicit=b,g}_maybeCacheView(s,c){if(this._viewCache.length<this.viewCacheSize)this._viewCache.push(s);else{const m=c.indexOf(s);-1===m?s.destroy():c.remove(m)}}_insertViewFromCache(s,c){const m=this._viewCache.pop();return m&&c.insert(m,s),m||null}}class O{_multiple;_emitChanges;compareWith;_selection=new Set;_deselectedToEmit=[];_selectedToEmit=[];_selected;get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}changed=new j.B;constructor(s=!1,c,m=!0,b){this._multiple=s,this._emitChanges=m,this.compareWith=b,c&&c.length&&(s?c.forEach(g=>this._markSelected(g)):this._markSelected(c[0]),this._selectedToEmit.length=0)}select(...s){this._verifyValueAssignment(s),s.forEach(m=>this._markSelected(m));const c=this._hasQueuedChanges();return this._emitChangeEvent(),c}deselect(...s){this._verifyValueAssignment(s),s.forEach(m=>this._unmarkSelected(m));const c=this._hasQueuedChanges();return this._emitChangeEvent(),c}setSelection(...s){this._verifyValueAssignment(s);const c=this.selected,m=new Set(s);s.forEach(g=>this._markSelected(g)),c.filter(g=>!m.has(this._getConcreteValue(g,m))).forEach(g=>this._unmarkSelected(g));const b=this._hasQueuedChanges();return this._emitChangeEvent(),b}toggle(s){return this.isSelected(s)?this.deselect(s):this.select(s)}clear(s=!0){this._unmarkAll();const c=this._hasQueuedChanges();return s&&this._emitChangeEvent(),c}isSelected(s){return this._selection.has(this._getConcreteValue(s))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(s){this._multiple&&this.selected&&this._selected.sort(s)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(s){s=this._getConcreteValue(s),this.isSelected(s)||(this._multiple||this._unmarkAll(),this.isSelected(s)||this._selection.add(s),this._emitChanges&&this._selectedToEmit.push(s))}_unmarkSelected(s){s=this._getConcreteValue(s),this.isSelected(s)&&(this._selection.delete(s),this._emitChanges&&this._deselectedToEmit.push(s))}_unmarkAll(){this.isEmpty()||this._selection.forEach(s=>this._unmarkSelected(s))}_verifyValueAssignment(s){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(s,c){if(this.compareWith){c=c??this._selection;for(let m of c)if(this.compareWith(s,m))return m;return s}return s}}let L=(()=>{class u{_listeners=[];notify(c,m){for(let b of this._listeners)b(c,m)}listen(c){return this._listeners.push(c),()=>{this._listeners=this._listeners.filter(m=>c!==m)}}ngOnDestroy(){this._listeners=[]}static \u0275fac=function(m){return new(m||u)};static \u0275prov=E.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},5682:(Q,S,l)=>{l.r(S),l.d(S,{PostDetailComponent:()=>Me});var h=l(3014),t=l(3107),v=l(4460),j=l(4892),E=l(5329),C=l(9471),D=l(3904),V=l(3220),x=l(7702),F=l(1054),w=l(7859),f=l(7544),O=l(4466),A=l(7082);let L=(()=>{class i{appTitle="Beau's Blog";appBaseUrl=window.location.origin;getShareDataFromPost(e){const o=`${this.appBaseUrl}/#/blog/${e.id}`,n=e.excerpt||this.createExcerptFromContent(e.content),a=e.imageUrl?this.ensureAbsoluteUrl(e.imageUrl):void 0,d=e.publishedAt?.toDate?e.publishedAt.toDate():new Date(e.publishedAt);return{url:o,title:e.title,description:n,image:a,tags:e.tags,authorName:e.authorName,publishedDate:d,siteName:this.appTitle}}ensureAbsoluteUrl(e){return e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?`${this.appBaseUrl}${e}`:`${this.appBaseUrl}/${e}`}shareToFacebook(e){const o=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(e.url)}`;this.openShareWindow(o,"facebook-share")}shareToTwitter(e){const o=`${e.title}`,n=e.tags?.join(",")||"",a=`https://twitter.com/intent/tweet?url=${encodeURIComponent(e.url)}&text=${encodeURIComponent(o)}&hashtags=${encodeURIComponent(n)}`;this.openShareWindow(a,"twitter-share")}shareToLinkedIn(e){const o=`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(e.url)}&title=${encodeURIComponent(e.title)}&summary=${encodeURIComponent(e.description||"")}`;this.openShareWindow(o,"linkedin-share")}shareViaEmail(e){const o=encodeURIComponent(`${e.title} | ${this.appTitle}`),n=encodeURIComponent(`I thought you might be interested in this:\n\n${e.title}\n${e.description}\n\nRead more: ${e.url}`);window.location.href=`mailto:?subject=${o}&body=${n}`}createShareablePreviewCard(e){return`\n      <div style="border: 1px solid #ddd; border-radius: 8px; max-width: 500px; font-family: Arial, sans-serif;">\n        ${e.imageUrl?`<img src="${e.imageUrl}" alt="${e.title}" style="width: 100%; border-radius: 8px 8px 0 0; object-fit: cover; height: 250px;" />`:""}\n        <div style="padding: 16px;">\n          <h2 style="margin-top: 0; color: #333;">${e.title}</h2>\n          <p style="color: #666;">${e.excerpt||this.createExcerptFromContent(e.content)}</p>\n          <div style="display: flex; align-items: center; margin-top: 16px;">\n            ${e.authorPhotoURL?`<img src="${e.authorPhotoURL}" alt="${e.authorName}" style="width: 40px; height: 40px; border-radius: 50%; margin-right: 8px;" />`:""}\n            <div>\n              <div style="font-weight: bold;">${e.authorName}</div>\n              <div style="font-size: 0.8rem; color: #888;">${this.formatDate(e.publishedAt)}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `}copyLinkToClipboard(e){return(0,h.A)(function*(){try{return yield navigator.clipboard.writeText(e.url),!0}catch(o){return console.error("Failed to copy:",o),!1}})()}openShareWindow(e,o){window.open(e,o,"width=600,height=400,location=0,menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1")}createExcerptFromContent(e,o=150){const n=e.replace(/<[^>]*>/g,"");return n.length>o?n.substring(0,o)+"...":n}formatDate(e){return e?(e.toDate?e.toDate():new Date(e)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}static \u0275fac=function(o){return new(o||i)};static \u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var u=l(6388);let s=(()=>{class i{el;renderer;appCodeHighlight="";code="";constructor(e,o){this.el=e,this.renderer=o}ngAfterViewInit(){this.highlightCode()}ngOnChanges(e){(e.code||e.appCodeHighlight)&&setTimeout(()=>{this.highlightCode()},0)}highlightCode(){const e=this.code||this.el.nativeElement.textContent||"";if(!e.trim())return;const o=this.appCodeHighlight||"typescript";if(this.renderer.addClass(this.el.nativeElement,`language-${o}`),this.renderer.setAttribute(this.el.nativeElement,"data-language",o),this.el.nativeElement.textContent=e,typeof Prism<"u")Prism.highlightElement(this.el.nativeElement);else{console.warn("Prism library not loaded. Code highlighting will not work.");const n=this.renderer.createElement("code");for(this.renderer.addClass(n,`language-${o}`),this.renderer.appendChild(n,this.renderer.createText(e));this.el.nativeElement.firstChild;)this.renderer.removeChild(this.el.nativeElement,this.el.nativeElement.firstChild);this.renderer.appendChild(this.el.nativeElement,n)}}static \u0275fac=function(o){return new(o||i)(t.rXU(t.aKT),t.rXU(t.sFG))};static \u0275dir=t.FsC({type:i,selectors:[["","appCodeHighlight",""]],inputs:{appCodeHighlight:"appCodeHighlight",code:"code"},features:[t.OA$]})}return i})();var c=l(303),m=l(7043),b=l(7818),g=l(4032),p=l(936),k=l(7793),I=l(6389),R=l(708);const T=["commentFormElement"];function P(i,r){1&i&&(t.j41(0,"mat-error"),t.EFF(1," Comment content is required "),t.k0s())}function H(i,r){1&i&&(t.j41(0,"mat-error"),t.EFF(1," Comment cannot exceed 1000 characters "),t.k0s())}function J(i,r){1&i&&(t.j41(0,"p",14),t.EFF(1," Note: Your comment will need to be approved by a moderator before it appears publicly. "),t.k0s())}function q(i,r){if(1&i&&(t.j41(0,"div",12),t.DNE(1,J,2,0,"p",13),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ngIf",!e.isAutoApproved())}}function K(i,r){if(1&i){const e=t.RV6();t.j41(0,"button",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.onCancel())}),t.EFF(1," Cancel "),t.k0s()}if(2&i){const e=t.XpG();t.Y8G("disabled",e.submitting())}}function Z(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.JRh(e.getSubmitButtonText())}}function tt(i,r){1&i&&t.nrm(0,"mat-spinner",16)}let N=(()=>{class i{fb=(0,t.WQX)(p.ok);commentService=(0,t.WQX)(m.j);authService=(0,t.WQX)(A.u);snackBar=(0,t.WQX)(w.UG);postId;parentId;commentId;initialContent="";isEditing=!1;isReply=!1;depth=0;autoFocus=!1;commentAdded=new t.bkB;commentUpdated=new t.bkB;cancelEdit=new t.bkB;formElement;submitting=(0,t.vPA)(!1);formInitialized=(0,t.vPA)(!1);commentForm=this.fb.group({content:["",[p.k0.required,p.k0.maxLength(1e3)]]});handleClickOutside(e){if(this.formInitialized()&&!this.isEditing&&!this.submitting()&&this.formElement&&!this.formElement.nativeElement.contains(e.target)){const o=this.commentForm.get("content")?.value;(!o||""===o.trim())&&this.cancelEdit.emit()}}ngOnInit(){this.initialContent&&this.commentForm.patchValue({content:this.initialContent})}ngAfterViewInit(){this.formInitialized.set(!0),this.autoFocus&&this.formElement&&setTimeout(()=>{const e=this.formElement?.nativeElement.querySelector("textarea");e&&e.focus()},100)}isAdmin(){return"admin"===this.authService.profile()?.role}isAutoApproved(){const e=this.authService.profile()?.role;return"admin"===e||"author"===e}getSubmitButtonText(){return this.isEditing?"Update":this.isReply?"Reply":"Post Comment"}onSubmit(){var e=this;return(0,h.A)(function*(){if(e.commentForm.invalid)return;const o=e.commentForm.get("content")?.value||"";e.submitting.set(!0);try{if(e.isEditing&&e.commentId){yield e.commentService.updateComment(e.commentId,{content:o});const n=e.authService.currentUser(),a=e.authService.profile();if(!n||!a)throw new Error("User not found");const d={id:e.commentId,postId:e.postId,content:o,authorId:n.uid,authorName:a.displayName,authorPhotoURL:a.photoURL,depth:e.depth,status:e.isAutoApproved()?"approved":"pending",updatedAt:new Date};e.commentUpdated.emit(d),e.commentForm.reset();const _=e.isAutoApproved()?"Comment updated successfully.":"Comment updated and awaiting approval.";e.snackBar.open(_,"Close",{duration:3e3})}else{const n={postId:e.postId,content:o,depth:e.parentId?e.depth+1:0};e.parentId&&(n.parentId=e.parentId);const a=yield e.commentService.addComment(n),d=e.authService.currentUser(),_=e.authService.profile();if(!d||!_)throw new Error("User not found");const G={id:a,postId:e.postId,content:o,authorId:d.uid,authorName:_.displayName,depth:e.parentId?e.depth+1:0,status:e.isAutoApproved()?"approved":"pending",createdAt:new Date,updatedAt:new Date,likes:0,replyCount:0};_.photoURL&&(G.authorPhotoURL=_.photoURL),e.parentId&&(G.parentId=e.parentId),e.commentAdded.emit(G),e.commentForm.reset();const $=e.isAutoApproved()?"Comment posted successfully.":"Comment submitted and awaiting approval.";e.snackBar.open($,"Close",{duration:3e3})}}catch(n){console.error("Error saving comment:",n),e.snackBar.open("Error saving comment. Please try again.","Close",{duration:3e3})}finally{e.submitting.set(!1)}})()}onCancel(){this.commentForm.reset(),this.cancelEdit.emit()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=t.VBU({type:i,selectors:[["app-comment-form"]],viewQuery:function(o,n){if(1&o&&t.GBs(T,5),2&o){let a;t.mGM(a=t.lsd())&&(n.formElement=a.first)}},hostBindings:function(o,n){1&o&&t.bIt("click",function(d){return n.handleClickOutside(d)},!1,t.EBC)},inputs:{postId:"postId",parentId:"parentId",commentId:"commentId",initialContent:"initialContent",isEditing:"isEditing",isReply:"isReply",depth:"depth",autoFocus:"autoFocus"},outputs:{commentAdded:"commentAdded",commentUpdated:"commentUpdated",cancelEdit:"cancelEdit"},decls:18,vars:11,consts:[["commentFormElement",""],["autosize","cdkTextareaAutosize"],[1,"comment-form",3,"ngSubmit","click","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","content","rows","3","cdkTextareaAutosize","","cdkAutosizeMinRows","3","cdkAutosizeMaxRows","10",3,"placeholder"],[4,"ngIf"],["align","end"],["class","comment-status",4,"ngIf"],[1,"form-actions"],["type","button","mat-button","",3,"disabled","click",4,"ngIf"],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["diameter","20",4,"ngIf"],[1,"comment-status"],["class","status-note",4,"ngIf"],[1,"status-note"],["type","button","mat-button","",3,"click","disabled"],["diameter","20"]],template:function(o,n){if(1&o){const a=t.RV6();t.j41(0,"form",2,0),t.bIt("ngSubmit",function(){return t.eBV(a),t.Njj(n.onSubmit())})("click",function(_){return t.eBV(a),t.Njj(_.stopPropagation())}),t.j41(2,"mat-form-field",3)(3,"mat-label"),t.EFF(4),t.k0s(),t.j41(5,"textarea",4,1),t.EFF(7,"        "),t.k0s(),t.DNE(8,P,2,0,"mat-error",5)(9,H,2,0,"mat-error",5),t.j41(10,"mat-hint",6),t.EFF(11),t.k0s()(),t.DNE(12,q,2,1,"div",7),t.j41(13,"div",8),t.DNE(14,K,2,1,"button",9),t.j41(15,"button",10),t.DNE(16,Z,2,1,"span",5)(17,tt,1,0,"mat-spinner",11),t.k0s()()()}if(2&o){let a,d,_;t.Y8G("formGroup",n.commentForm),t.R7$(4),t.JRh(n.isEditing?"Edit your comment":"Write a comment"),t.R7$(),t.Y8G("placeholder",n.isReply?"Write a reply...":n.isEditing?"Edit your comment":"Join the discussion..."),t.R7$(3),t.Y8G("ngIf",null==(a=n.commentForm.get("content"))?null:a.hasError("required")),t.R7$(),t.Y8G("ngIf",null==(d=n.commentForm.get("content"))?null:d.hasError("maxlength")),t.R7$(2),t.SpI("",(null==(_=n.commentForm.get("content"))||null==_.value?null:_.value.length)||0,"/1000"),t.R7$(),t.Y8G("ngIf",!n.isAdmin()),t.R7$(2),t.Y8G("ngIf",n.isEditing||n.isReply),t.R7$(),t.Y8G("disabled",n.commentForm.invalid||n.submitting()),t.R7$(),t.Y8G("ngIf",!n.submitting()),t.R7$(),t.Y8G("ngIf",n.submitting())}},dependencies:[v.MD,v.bT,p.X1,p.qT,p.me,p.BC,p.cb,p.j4,p.JD,k.RG,k.rl,k.nJ,k.MV,k.TL,I.fS,I.fg,R.xb,C.Hl,C.$z,F.D6,F.LG],styles:[".comment-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:16px}.full-width[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:8px}button[type=submit][_ngcontent-%COMP%]{min-width:120px;position:relative}mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.comment-status[_ngcontent-%COMP%]{margin-top:4px;font-size:.85rem}.status-note[_ngcontent-%COMP%]{color:var(--text-secondary);font-style:italic;margin:0}"]})}return i})();var B=l(8559),et=l(1349),M=l(2902),ot=l(5467);const nt=["input"],it=["formField"],at=["*"];class Y{source;value;constructor(r,e){this.source=r,this.value=e}}const rt={provide:p.kq,useExisting:(0,t.Rfq)(()=>W),multi:!0},z=new t.nKC("MatRadioGroup"),st=new t.nKC("mat-radio-default-options",{providedIn:"root",factory:function ct(){return{color:"accent",disabledInteractive:!1}}});let W=(()=>{class i{_changeDetector=(0,t.WQX)(t.gRc);_value=null;_name=(0,t.WQX)(B.g7).getId("mat-radio-group-");_selected=null;_isInitialized=!1;_labelPosition="after";_disabled=!1;_required=!1;_buttonChanges;_controlValueAccessorChangeFn=()=>{};onTouched=()=>{};change=new t.bkB;_radios;color;get name(){return this._name}set name(e){this._name=e,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(e){this._labelPosition="before"===e?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(e){this._selected=e,this.value=e?e.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._markRadiosForCheck()}get required(){return this._required}set required(e){this._required=e,this._markRadiosForCheck()}get disabledInteractive(){return this._disabledInteractive}set disabledInteractive(e){this._disabledInteractive=e,this._markRadiosForCheck()}_disabledInteractive=!1;constructor(){}ngAfterContentInit(){this._isInitialized=!0,this._buttonChanges=this._radios.changes.subscribe(()=>{this.selected&&!this._radios.find(e=>e===this.selected)&&(this._selected=null)})}ngOnDestroy(){this._buttonChanges?.unsubscribe()}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(e=>{e.name=this.name,e._markForCheck()})}_updateSelectedRadioFromValue(){this._radios&&(null===this._selected||this._selected.value!==this._value)&&(this._selected=null,this._radios.forEach(o=>{o.checked=this.value===o.value,o.checked&&(this._selected=o)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new Y(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(e=>e._markForCheck())}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetector.markForCheck()}static \u0275fac=function(o){return new(o||i)};static \u0275dir=t.FsC({type:i,selectors:[["mat-radio-group"]],contentQueries:function(o,n,a){if(1&o&&t.wni(a,U,5),2&o){let d;t.mGM(d=t.lsd())&&(n._radios=d)}},hostAttrs:["role","radiogroup",1,"mat-mdc-radio-group"],inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:[2,"disabled","disabled",t.L39],required:[2,"required","required",t.L39],disabledInteractive:[2,"disabledInteractive","disabledInteractive",t.L39]},outputs:{change:"change"},exportAs:["matRadioGroup"],features:[t.Jv_([rt,{provide:z,useExisting:i}])]})}return i})(),U=(()=>{class i{_elementRef=(0,t.WQX)(t.aKT);_changeDetector=(0,t.WQX)(t.gRc);_focusMonitor=(0,t.WQX)(B.FN);_radioDispatcher=(0,t.WQX)(et.zP);_defaultOptions=(0,t.WQX)(st,{optional:!0});_ngZone=(0,t.WQX)(t.SKi);_renderer=(0,t.WQX)(t.sFG);_uniqueId=(0,t.WQX)(B.g7).getId("mat-radio-");_cleanupClick;id=this._uniqueId;name;ariaLabel;ariaLabelledby;ariaDescribedby;disableRipple=!1;tabIndex=0;get checked(){return this._checked}set checked(e){this._checked!==e&&(this._checked=e,e&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!e&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),e&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===e),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(e){this._labelPosition=e}_labelPosition;get disabled(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled}set disabled(e){this._setDisabled(e)}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(e){this._required=e}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._defaultOptions&&this._defaultOptions.color||"accent"}set color(e){this._color=e}_color;get disabledInteractive(){return this._disabledInteractive||null!==this.radioGroup&&this.radioGroup.disabledInteractive}set disabledInteractive(e){this._disabledInteractive=e}_disabledInteractive;change=new t.bkB;radioGroup;get inputId(){return`${this.id||this._uniqueId}-input`}_checked=!1;_disabled;_required;_value=null;_removeUniqueSelectionListener=()=>{};_previousTabIndex;_inputElement;_rippleTrigger;_noopAnimations;_injector=(0,t.WQX)(t.zZn);constructor(){(0,t.WQX)(ot.l).load(M.Ah);const e=(0,t.WQX)(z,{optional:!0}),o=(0,t.WQX)(t.bc$,{optional:!0}),n=(0,t.WQX)(new t.ES_("tabindex"),{optional:!0});this.radioGroup=e,this._noopAnimations="NoopAnimations"===o,this._disabledInteractive=this._defaultOptions?.disabledInteractive??!1,n&&(this.tabIndex=(0,t.Udg)(n,0))}focus(e,o){o?this._focusMonitor.focusVia(this._inputElement,o,e):this._inputElement.nativeElement.focus(e)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((e,o)=>{e!==this.id&&o===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{!e&&this.radioGroup&&this.radioGroup._touch()}),this._ngZone.runOutsideAngular(()=>{this._cleanupClick=this._renderer.listen(this._inputElement.nativeElement,"click",this._onInputClick)})}ngOnDestroy(){this._cleanupClick?.(),this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new Y(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputInteraction(e){if(e.stopPropagation(),!this.checked&&!this.disabled){const o=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),o&&this.radioGroup._emitChangeEvent())}}_onTouchTargetClick(e){this._onInputInteraction(e),(!this.disabled||this.disabledInteractive)&&this._inputElement?.nativeElement.focus()}_setDisabled(e){this._disabled!==e&&(this._disabled=e,this._changeDetector.markForCheck())}_onInputClick=e=>{this.disabled&&this.disabledInteractive&&e.preventDefault()};_updateTabIndex(){const e=this.radioGroup;let o;if(o=e&&e.selected&&!this.disabled?e.selected===this?this.tabIndex:-1:this.tabIndex,o!==this._previousTabIndex){const n=this._inputElement?.nativeElement;n&&(n.setAttribute("tabindex",o+""),this._previousTabIndex=o,(0,t.mal)(()=>{queueMicrotask(()=>{e&&e.selected&&e.selected!==this&&document.activeElement===n&&(e.selected?._inputElement.nativeElement.focus(),document.activeElement===n&&this._inputElement.nativeElement.blur())})},{injector:this._injector}))}}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=t.VBU({type:i,selectors:[["mat-radio-button"]],viewQuery:function(o,n){if(1&o&&(t.GBs(nt,5),t.GBs(it,7,t.aKT)),2&o){let a;t.mGM(a=t.lsd())&&(n._inputElement=a.first),t.mGM(a=t.lsd())&&(n._rippleTrigger=a.first)}},hostAttrs:[1,"mat-mdc-radio-button"],hostVars:19,hostBindings:function(o,n){1&o&&t.bIt("focus",function(){return n._inputElement.nativeElement.focus()}),2&o&&(t.BMQ("id",n.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),t.AVh("mat-primary","primary"===n.color)("mat-accent","accent"===n.color)("mat-warn","warn"===n.color)("mat-mdc-radio-checked",n.checked)("mat-mdc-radio-disabled",n.disabled)("mat-mdc-radio-disabled-interactive",n.disabledInteractive)("_mat-animation-noopable",n._noopAnimations))},inputs:{id:"id",name:"name",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],disableRipple:[2,"disableRipple","disableRipple",t.L39],tabIndex:[2,"tabIndex","tabIndex",e=>null==e?0:(0,t.Udg)(e)],checked:[2,"checked","checked",t.L39],value:"value",labelPosition:"labelPosition",disabled:[2,"disabled","disabled",t.L39],required:[2,"required","required",t.L39],color:"color",disabledInteractive:[2,"disabledInteractive","disabledInteractive",t.L39]},outputs:{change:"change"},exportAs:["matRadioButton"],ngContentSelectors:at,decls:13,vars:17,consts:[["formField",""],["input",""],["mat-internal-form-field","",3,"labelPosition"],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio",1,"mdc-radio__native-control",3,"change","id","checked","disabled","required"],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(o,n){if(1&o){const a=t.RV6();t.NAR(),t.j41(0,"div",2,0)(2,"div",3)(3,"div",4),t.bIt("click",function(_){return t.eBV(a),t.Njj(n._onTouchTargetClick(_))}),t.k0s(),t.j41(4,"input",5,1),t.bIt("change",function(_){return t.eBV(a),t.Njj(n._onInputInteraction(_))}),t.k0s(),t.j41(6,"div",6),t.nrm(7,"div",7)(8,"div",8),t.k0s(),t.j41(9,"div",9),t.nrm(10,"div",10),t.k0s()(),t.j41(11,"label",11),t.SdG(12),t.k0s()()}2&o&&(t.Y8G("labelPosition",n.labelPosition),t.R7$(2),t.AVh("mdc-radio--disabled",n.disabled),t.R7$(2),t.Y8G("id",n.inputId)("checked",n.checked)("disabled",n.disabled&&!n.disabledInteractive)("required",n.required),t.BMQ("name",n.name)("value",n.value)("aria-label",n.ariaLabel)("aria-labelledby",n.ariaLabelledby)("aria-describedby",n.ariaDescribedby)("aria-disabled",n.disabled&&n.disabledInteractive?"true":null),t.R7$(5),t.Y8G("matRippleTrigger",n._rippleTrigger.nativeElement)("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",!0),t.R7$(2),t.Y8G("for",n.inputId))},dependencies:[M.r6,M.tO],styles:['.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color;padding:calc((var(--mdc-radio-state-layer-size, 40px) - 20px)/2)}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:not([disabled])~.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-hover-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:hover>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-hover-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-pressed-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:active>.mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-pressed-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mat-mdc-radio-button .mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);width:var(--mdc-radio-state-layer-size, 40px);height:var(--mdc-radio-state-layer-size, 40px);top:calc(-1*(var(--mdc-radio-state-layer-size, 40px) - 20px)/2);left:calc(-1*(var(--mdc-radio-state-layer-size, 40px) - 20px)/2)}.mat-mdc-radio-button .mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;top:0;right:0;left:0;cursor:inherit;z-index:1;width:var(--mdc-radio-state-layer-size, 40px);height:var(--mdc-radio-state-layer-size, 40px)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__outer-circle{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__inner-circle{transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{cursor:default}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background>.mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-focus-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle{transform:scale(0.5);transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled{pointer-events:auto}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:not(:checked)+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background>.mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background>.mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color, var(--mat-sys-primary))}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mat-internal-form-field{color:var(--mat-radio-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-radio-label-text-font, var(--mat-sys-body-medium-font));line-height:var(--mat-radio-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-radio-label-text-size, var(--mat-sys-body-medium-size));letter-spacing:var(--mat-radio-label-text-tracking, var(--mat-sys-body-medium-tracking));font-weight:var(--mat-radio-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple>.mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button .mdc-radio>.mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background>.mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-focus-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button.cdk-focused .mat-focus-indicator::before{content:""}.mat-mdc-radio-disabled{cursor:default;pointer-events:none}.mat-mdc-radio-disabled.mat-mdc-radio-disabled-interactive{pointer-events:auto}.mat-mdc-radio-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-radio-touch-target-display, block)}[dir=rtl] .mat-mdc-radio-touch-target{left:auto;right:50%;transform:translate(50%, -50%)}'],encapsulation:2,changeDetection:0})}return i})(),mt=(()=>{class i{static \u0275fac=function(o){return new(o||i)};static \u0275mod=t.$C({type:i});static \u0275inj=t.G2t({imports:[M.yE,M.pZ,U,M.yE]})}return i})();function dt(i,r){1&i&&(t.j41(0,"mat-error"),t.EFF(1," Explanation is required when selecting 'Other' "),t.k0s())}function lt(i,r){if(1&i&&(t.j41(0,"mat-form-field",14)(1,"mat-label"),t.EFF(2,"Please explain"),t.k0s(),t.j41(3,"textarea",15),t.EFF(4,"          "),t.k0s(),t.DNE(5,dt,2,0,"mat-error",12),t.k0s()),2&i){let e;const o=t.XpG();t.R7$(5),t.Y8G("ngIf",null==(e=o.flagForm.get("explanation"))?null:e.hasError("required"))}}function pt(i,r){1&i&&(t.j41(0,"span"),t.EFF(1,"Flag Comment"),t.k0s())}function ut(i,r){1&i&&t.nrm(0,"mat-spinner",16)}let _t=(()=>{class i{data;fb=(0,t.WQX)(p.ok);commentService=(0,t.WQX)(m.j);dialogRef=(0,t.WQX)(f.CP);commentId="";submitting=(0,t.vPA)(!1);flagForm=this.fb.group({reason:["spam",p.k0.required],explanation:[""]});constructor(e){this.data=e,console.debug(e.commentId),this.flagForm.get("reason")?.valueChanges.subscribe(o=>{const n=this.flagForm.get("explanation");"other"===o?n?.setValidators(p.k0.required):n?.clearValidators(),n?.updateValueAndValidity()})}needsExplanation(){return"other"===this.flagForm.get("reason")?.value}submitFlag(){var e=this;return(0,h.A)(function*(){if(e.flagForm.valid){e.submitting.set(!0);try{const o=e.flagForm.get("reason")?.value||"spam",n=e.flagForm.get("explanation")?.value||"";let a=o;"other"===o&&n&&(a=`${o}: ${n}`),yield e.commentService.flagCommentByUser(e.data.commentId,a),e.dialogRef.close(!0)}catch(o){console.error("Error flagging comment:",o)}finally{e.submitting.set(!1)}}})()}static \u0275fac=function(o){return new(o||i)(t.rXU(f.Vh))};static \u0275cmp=t.VBU({type:i,selectors:[["app-flag-comment-dialog"]],decls:22,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["formControlName","reason",1,"flag-radio-group"],["value","spam"],["value","offensive"],["value","harassment"],["value","other"],["appearance","outline","class","full-width",4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-button","","mat-dialog-close",""],["mat-raised-button","","color","warn",3,"click","disabled"],[4,"ngIf"],["diameter","20",4,"ngIf"],["appearance","outline",1,"full-width"],["matInput","","formControlName","explanation","rows","3","placeholder","Please provide more details about why this comment is inappropriate"],["diameter","20"]],template:function(o,n){1&o&&(t.j41(0,"h2",0),t.EFF(1,"Flag Comment"),t.k0s(),t.j41(2,"div",1)(3,"p"),t.EFF(4,"Please tell us why you're flagging this comment:"),t.k0s(),t.j41(5,"form",2)(6,"mat-radio-group",3)(7,"mat-radio-button",4),t.EFF(8,"Spam"),t.k0s(),t.j41(9,"mat-radio-button",5),t.EFF(10,"Offensive content"),t.k0s(),t.j41(11,"mat-radio-button",6),t.EFF(12,"Harassment"),t.k0s(),t.j41(13,"mat-radio-button",7),t.EFF(14,"Other"),t.k0s()(),t.DNE(15,lt,6,1,"mat-form-field",8),t.k0s()(),t.j41(16,"div",9)(17,"button",10),t.EFF(18,"Cancel"),t.k0s(),t.j41(19,"button",11),t.bIt("click",function(){return n.submitFlag()}),t.DNE(20,pt,2,0,"span",12)(21,ut,1,0,"mat-spinner",13),t.k0s()()),2&o&&(t.R7$(5),t.Y8G("formGroup",n.flagForm),t.R7$(10),t.Y8G("ngIf",n.needsExplanation()),t.R7$(4),t.Y8G("disabled",!n.flagForm.valid||n.submitting()),t.R7$(),t.Y8G("ngIf",!n.submitting()),t.R7$(),t.Y8G("ngIf",n.submitting()))},dependencies:[v.MD,v.bT,p.X1,p.qT,p.me,p.BC,p.cb,p.j4,p.JD,f.hM,f.tx,f.BI,f.E7,f.Yi,k.RG,k.rl,k.nJ,k.TL,I.fS,I.fg,C.Hl,C.$z,mt,W,U,F.D6,F.LG],styles:[".flag-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-bottom:16px}.full-width[_ngcontent-%COMP%]{width:100%}"]})}return i})();var ht=l(6927);const X=i=>["/user/profile",i];function gt(i,r){if(1&i&&t.nrm(0,"img",23),2&i){const e=t.XpG();t.Y8G("src",e.comment.authorPhotoURL,t.B4B)("routerLink",t.eq3(2,X,e.comment.authorId))}}function ft(i,r){if(1&i&&(t.j41(0,"mat-icon",24),t.EFF(1,"account_circle"),t.k0s()),2&i){const e=t.XpG();t.Y8G("routerLink",t.eq3(1,X,e.comment.authorId))}}function bt(i,r){if(1&i&&(t.j41(0,"div",25)(1,"span"),t.EFF(2),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.HbH("badge badge-"+e.comment.status),t.R7$(),t.JRh(e.comment.status)}}function vt(i,r){if(1&i&&(t.j41(0,"button",26)(1,"mat-icon"),t.EFF(2,"more_vert"),t.k0s()()),2&i){t.XpG();const e=t.sdS(15);t.Y8G("matMenuTriggerFor",e)}}function Ct(i,r){if(1&i){const e=t.RV6();t.j41(0,"button",14),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.startEditing())}),t.j41(1,"mat-icon"),t.EFF(2,"edit"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Edit"),t.k0s()()}}function kt(i,r){if(1&i&&(t.j41(0,"div",27),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.AVh("deleted","deleted"===e.comment.status),t.R7$(),t.SpI(" ",e.comment.content," ")}}function yt(i,r){if(1&i&&(t.j41(0,"div",28),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI(" Edited ",e.formatDate(e.comment.updatedAt)," ")}}function xt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",29)(1,"app-comment-form",30),t.bIt("commentUpdated",function(n){t.eBV(e);const a=t.XpG();return t.Njj(a.onCommentUpdated(n))})("cancelEdit",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancelEditing())}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("initialContent",e.comment.content)("isEditing",!0)("isReply",!1)("depth",e.comment.depth)("postId",e.postId)("commentId",e.comment.id)}}function It(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI("(",e.comment.replyCount,")")}}function Et(i,r){if(1&i){const e=t.RV6();t.j41(0,"button",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.approveComment())}),t.j41(1,"mat-icon"),t.EFF(2,"check_circle"),t.k0s(),t.EFF(3," Approve "),t.k0s()}}function Ft(i,r){if(1&i){const e=t.RV6();t.j41(0,"button",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.flagComment())}),t.j41(1,"mat-icon"),t.EFF(2,"flag"),t.k0s(),t.EFF(3," Flag "),t.k0s()}}function Rt(i,r){if(1&i&&(t.qex(0),t.DNE(1,Et,4,0,"button",31)(2,Ft,4,0,"button",32),t.bVm()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ngIf","approved"!==e.comment.status),t.R7$(),t.Y8G("ngIf","flagged"!==e.comment.status)}}function Tt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",35)(1,"app-comment-form",36),t.bIt("commentAdded",function(n){t.eBV(e);const a=t.XpG();return t.Njj(a.onReplyAdded(n))})("cancelEdit",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.toggleReplyForm())}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("postId",e.postId)("parentId",e.comment.id)("isReply",!0)("depth",e.comment.depth)("autoFocus",!0)}}function Dt(i,r){1&i&&(t.j41(0,"div",41),t.nrm(1,"mat-spinner",42),t.k0s())}function jt(i,r){if(1&i){const e=t.RV6();t.j41(0,"app-comment-item",46),t.bIt("commentDeleted",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onReplyDeleted(n))})("commentUpdated",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onReplyUpdated(n))})("replyAdded",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onNestedReplyAdded(n))}),t.k0s()}if(2&i){const e=r.$implicit,o=t.XpG(3);t.Y8G("comment",e)("postId",o.postId)("maxDepth",o.maxDepth)}}function Gt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",47)(1,"button",48),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.loadMoreReplies())}),t.EFF(2),t.k0s()()}if(2&i){const e=t.XpG(3);t.R7$(),t.Y8G("disabled",e.loadingMoreReplies()),t.R7$(),t.SpI(" ",e.loadingMoreReplies()?"Loading...":"Load More Replies"," ")}}function wt(i,r){if(1&i&&(t.j41(0,"div",43),t.DNE(1,jt,1,3,"app-comment-item",44)(2,Gt,3,2,"div",45),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngForOf",e.replies()),t.R7$(),t.Y8G("ngIf",e.hasMoreReplies())}}function Pt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",49)(1,"a",50),t.bIt("click",function(n){return t.eBV(e),t.XpG(2).toggleReplies(),t.Njj(n.preventDefault())}),t.EFF(2),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(2),t.Lme(" View ",e.comment.replyCount," ",1===e.comment.replyCount?"reply":"replies"," ")}}function Mt(i,r){if(1&i&&(t.j41(0,"div",37),t.DNE(1,Dt,2,0,"div",38)(2,wt,3,2,"div",39)(3,Pt,3,2,"div",40),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ngIf",e.repliesLoading()),t.R7$(),t.Y8G("ngIf",!e.repliesLoading()&&e.showReplies()),t.R7$(),t.Y8G("ngIf",!e.repliesLoading()&&!e.showReplies()&&e.hasReplies())}}let At=(()=>{class i{commentService=(0,t.WQX)(m.j);authService=(0,t.WQX)(A.u);dialog=(0,t.WQX)(f.bZ);comment;postId;maxDepth=10;commentDeleted=new t.bkB;commentUpdated=new t.bkB;replyAdded=new t.bkB;isEditing=(0,t.vPA)(!1);showReplyForm=(0,t.vPA)(!1);isLiked=(0,t.vPA)(!1);likeInProgress=(0,t.vPA)(!1);replies=(0,t.vPA)([]);repliesLoading=(0,t.vPA)(!1);showReplies=(0,t.vPA)(!1);hasMoreReplies=(0,t.vPA)(!1);loadingMoreReplies=(0,t.vPA)(!1);lastVisibleReply=null;ngOnInit(){}loadReplies(){var e=this;return(0,h.A)(function*(){if(e.comment.id)try{e.repliesLoading.set(!0);const{replies:o,lastVisible:n}=yield e.commentService.getRepliesByCommentId(e.comment.id);e.replies.set(o),e.lastVisibleReply=n,e.hasMoreReplies.set(o.length>=10)}catch(o){console.error("Error loading replies:",o)}finally{e.repliesLoading.set(!1)}})()}loadMoreReplies(){var e=this;return(0,h.A)(function*(){if(e.comment.id&&e.lastVisibleReply)try{e.loadingMoreReplies.set(!0);const{replies:o,lastVisible:n}=yield e.commentService.getRepliesByCommentId(e.comment.id,e.lastVisibleReply);e.replies.update(a=>[...a,...o]),e.lastVisibleReply=n,e.hasMoreReplies.set(o.length>=10)}catch(o){console.error("Error loading more replies:",o)}finally{e.loadingMoreReplies.set(!1)}})()}canModifyComment(){const e=this.authService.currentUser();if(!e)return!1;const o=e.uid===this.comment.authorId,n="admin"===this.authService.profile()?.role;return o||n}canEditComment(){const e=this.authService.currentUser();return!!e&&e.uid===this.comment.authorId}isAdmin(){return"admin"===this.authService.profile()?.role}hasReplies(){return this.comment.replyCount&&this.comment.replyCount>0||this.replies().length>0}isEdited(){if(!this.comment.createdAt||!this.comment.updatedAt)return!1;const e=this.comment.createdAt.toDate?this.comment.createdAt.toDate():new Date(this.comment.createdAt),o=this.comment.updatedAt.toDate?this.comment.updatedAt.toDate():new Date(this.comment.updatedAt);return Math.abs(o.getTime()-e.getTime())>6e4}formatDate(e){if(!e)return"";const o=e.toDate?e.toDate():new Date(e),n=new Date;if(o.toDateString()===n.toDateString())return o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});const a=new Date;return a.setDate(a.getDate()-7),o>a?o.toLocaleDateString("en-US",{weekday:"short"})+" "+o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):o.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}indentForDepth(e){return 20*Math.min(e,8)}startEditing(){this.isEditing.set(!0)}cancelEditing(){this.isEditing.set(!1)}toggleReplyForm(){console.log("Toggling reply form, current state:",this.showReplyForm()),this.showReplyForm.update(e=>!e),console.log("New reply form state:",this.showReplyForm())}handleReplyClick(e){e.stopPropagation(),console.log("Reply button clicked"),this.toggleReplyForm()}toggleReplies(){var e=this;return(0,h.A)(function*(){0===e.replies().length&&e.comment.replyCount&&e.comment.replyCount>0&&(yield e.loadReplies()),e.showReplies.update(o=>!o)})()}deleteComment(){var e=this;return(0,h.A)(function*(){e.dialog.open(ht.w,{width:"350px",data:{title:"Delete Comment",message:"Are you sure you want to delete this comment? This action cannot be undone.",confirmButton:"Delete",cancelButton:"Cancel"}}).afterClosed().subscribe(function(){var n=(0,h.A)(function*(a){if(a)try{yield e.commentService.deleteComment(e.comment.id),e.comment.replyCount&&0!==e.comment.replyCount?(e.comment={...e.comment,content:"[This comment has been deleted]",status:"deleted"},e.commentUpdated.emit(e.comment)):e.commentDeleted.emit(e.comment.id)}catch(d){console.error("Error deleting comment:",d)}});return function(a){return n.apply(this,arguments)}}())})()}likeComment(){var e=this;return(0,h.A)(function*(){if(!e.likeInProgress()){e.likeInProgress.set(!0);try{yield e.commentService.likeComment(e.comment.id),e.isLiked.update(n=>!n);const o=(e.comment.likes||0)+(e.isLiked()?1:-1);e.comment={...e.comment,likes:o},e.commentUpdated.emit(e.comment)}catch(o){console.error("Error liking comment:",o)}finally{e.likeInProgress.set(!1)}}})()}openFlagDialog(){this.dialog.open(_t,{width:"400px",data:{commentId:this.comment.id}}).afterClosed().subscribe(o=>{o&&(this.comment={...this.comment,status:"flagged"},this.commentUpdated.emit(this.comment))})}approveComment(){var e=this;return(0,h.A)(function*(){try{yield e.commentService.moderateComment(e.comment.id,"approved"),e.comment={...e.comment,status:"approved"},e.commentUpdated.emit(e.comment)}catch(o){console.error("Error approving comment:",o)}})()}flagComment(){var e=this;return(0,h.A)(function*(){try{yield e.commentService.moderateComment(e.comment.id,"flagged"),e.comment={...e.comment,status:"flagged"},e.commentUpdated.emit(e.comment)}catch(o){console.error("Error flagging comment:",o)}})()}onCommentUpdated(e){this.comment=e,this.commentUpdated.emit(e),this.isEditing.set(!1)}onReplyAdded(e){this.replies.update(o=>[e,...o]),this.comment={...this.comment,replyCount:(this.comment.replyCount||0)+1},this.showReplies.set(!0),this.replyAdded.emit(e),this.showReplyForm.set(!1)}onReplyDeleted(e){this.replies.update(o=>o.filter(n=>n.id!==e)),this.comment={...this.comment,replyCount:Math.max(0,(this.comment.replyCount||0)-1)}}onReplyUpdated(e){this.replies.update(o=>o.map(n=>n.id===e.id?e:n))}onNestedReplyAdded(e){this.replyAdded.emit(e)}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=t.VBU({type:i,selectors:[["app-comment-item"]],inputs:{comment:"comment",postId:"postId",maxDepth:"maxDepth"},outputs:{commentDeleted:"commentDeleted",commentUpdated:"commentUpdated",replyAdded:"replyAdded"},decls:43,vars:26,consts:[["commentMenu","matMenu"],[1,"comment-container"],[1,"comment-card"],[1,"comment-header"],[1,"author-info"],[1,"author-avatar","clickable-avatar"],["alt","Author","class","clickable-avatar",3,"src","routerLink",4,"ngIf"],["class","clickable-avatar",3,"routerLink",4,"ngIf"],[1,"author-details"],[1,"author-name","clickable-name",3,"routerLink"],[1,"comment-date"],["class","status-badge",4,"ngIf"],["mat-icon-button","","aria-label","Comment actions",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],["color","warn"],["class","comment-content",3,"deleted",4,"ngIf"],["class","edit-timestamp",4,"ngIf"],["class","comment-edit-form",4,"ngIf"],["mat-button","",3,"click","disabled"],[4,"ngIf"],["class","reply-form",4,"ngIf"],["class","replies-section",4,"ngIf"],["alt","Author",1,"clickable-avatar",3,"src","routerLink"],[1,"clickable-avatar",3,"routerLink"],[1,"status-badge"],["mat-icon-button","","aria-label","Comment actions",3,"matMenuTriggerFor"],[1,"comment-content"],[1,"edit-timestamp"],[1,"comment-edit-form"],[3,"commentUpdated","cancelEdit","initialContent","isEditing","isReply","depth","postId","commentId"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"],[1,"reply-form"],[3,"commentAdded","cancelEdit","postId","parentId","isReply","depth","autoFocus"],[1,"replies-section"],["class","replies-loading",4,"ngIf"],["class","replies-container",4,"ngIf"],["class","toggle-replies",4,"ngIf"],[1,"replies-loading"],["diameter","30"],[1,"replies-container"],[3,"comment","postId","maxDepth","commentDeleted","commentUpdated","replyAdded",4,"ngFor","ngForOf"],["class","load-more",4,"ngIf"],[3,"commentDeleted","commentUpdated","replyAdded","comment","postId","maxDepth"],[1,"load-more"],["mat-button","","color","primary",3,"click","disabled"],[1,"toggle-replies"],["href","#",1,"reply-count-link",3,"click"]],template:function(o,n){if(1&o){const a=t.RV6();t.j41(0,"div",1)(1,"mat-card",2)(2,"div",3)(3,"div",4)(4,"div",5),t.DNE(5,gt,1,4,"img",6)(6,ft,2,3,"mat-icon",7),t.k0s(),t.j41(7,"div",8)(8,"div",9),t.EFF(9),t.k0s(),t.j41(10,"div",10),t.EFF(11),t.k0s()()(),t.DNE(12,bt,3,3,"div",11)(13,vt,3,1,"button",12),t.j41(14,"mat-menu",null,0),t.DNE(16,Ct,5,0,"button",13),t.j41(17,"button",14),t.bIt("click",function(){return t.eBV(a),t.Njj(n.deleteComment())}),t.j41(18,"mat-icon",15),t.EFF(19,"delete"),t.k0s(),t.j41(20,"span"),t.EFF(21,"Delete"),t.k0s()()()(),t.j41(22,"mat-card-content"),t.DNE(23,kt,2,3,"div",16)(24,yt,2,1,"div",17)(25,xt,2,6,"div",18),t.k0s(),t.j41(26,"mat-card-actions")(27,"button",19),t.bIt("click",function(){return t.eBV(a),t.Njj(n.likeComment())}),t.j41(28,"mat-icon"),t.EFF(29),t.k0s(),t.EFF(30),t.k0s(),t.j41(31,"button",19),t.bIt("click",function(_){return t.eBV(a),t.Njj(n.handleReplyClick(_))}),t.j41(32,"mat-icon"),t.EFF(33,"reply"),t.k0s(),t.EFF(34," Reply "),t.DNE(35,It,2,1,"span",20),t.k0s(),t.j41(36,"button",19),t.bIt("click",function(){return t.eBV(a),t.Njj(n.openFlagDialog())}),t.j41(37,"mat-icon"),t.EFF(38,"flag"),t.k0s(),t.EFF(39," Flag "),t.k0s(),t.DNE(40,Rt,3,2,"ng-container",20),t.k0s()(),t.DNE(41,Tt,2,5,"div",21)(42,Mt,4,3,"div",22),t.k0s()}2&o&&(t.xc7("margin-left",n.indentForDepth(n.comment.depth),"px"),t.R7$(),t.AVh("deleted","deleted"===n.comment.status),t.R7$(4),t.Y8G("ngIf",n.comment.authorPhotoURL),t.R7$(),t.Y8G("ngIf",!n.comment.authorPhotoURL),t.R7$(2),t.Y8G("routerLink",t.eq3(24,X,n.comment.authorId)),t.R7$(),t.SpI(" ",n.comment.authorName," "),t.R7$(2),t.JRh(n.formatDate(n.comment.createdAt)),t.R7$(),t.Y8G("ngIf",n.isAdmin()&&"approved"!==n.comment.status&&"deleted"!==n.comment.status),t.R7$(),t.Y8G("ngIf",n.canModifyComment()&&"deleted"!==n.comment.status),t.R7$(3),t.Y8G("ngIf",n.canEditComment()),t.R7$(7),t.Y8G("ngIf",!n.isEditing()),t.R7$(),t.Y8G("ngIf",!n.isEditing()&&n.isEdited()),t.R7$(),t.Y8G("ngIf",n.isEditing()),t.R7$(2),t.Y8G("disabled",n.likeInProgress()||"deleted"===n.comment.status),t.R7$(2),t.JRh(n.isLiked()?"favorite":"favorite_border"),t.R7$(),t.SpI(" ",n.comment.likes||0," "),t.R7$(),t.Y8G("disabled","deleted"===n.comment.status||n.comment.depth>=n.maxDepth),t.R7$(4),t.Y8G("ngIf",n.comment.replyCount&&n.comment.replyCount>0),t.R7$(),t.Y8G("disabled","deleted"===n.comment.status),t.R7$(4),t.Y8G("ngIf",n.isAdmin()&&"deleted"!==n.comment.status),t.R7$(),t.Y8G("ngIf",n.showReplyForm()),t.R7$(),t.Y8G("ngIf",n.hasReplies()))},dependencies:[i,v.MD,v.Sq,v.bT,E.Hu,E.RN,E.YY,E.m2,C.Hl,C.$z,C.iY,D.m_,D.An,b.Cn,b.kk,b.fb,b.Cp,x.w,g.Y,F.D6,F.LG,N,j.iI,j.Wk],styles:['.comment-container[_ngcontent-%COMP%]{position:relative;margin-bottom:0;padding-left:32px}.comment-container[_ngcontent-%COMP%]:before{content:"";position:absolute;left:22px;top:-6px;bottom:24px;border-left:2px solid rgba(0,0,0,.1);border-radius:2px}.comment-card[_ngcontent-%COMP%]{margin-bottom:8px;transition:background-color .3s ease}.comment-card.deleted[_ngcontent-%COMP%]{background-color:#00000008}.comment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}.author-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;position:relative}.author-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;overflow:hidden;display:flex;align-items:center;justify-content:center;background-color:var(--surface-color);position:relative;margin-right:8px;margin-left:-12px;z-index:1;border:2px solid white}.author-avatar[_ngcontent-%COMP%]:after{content:"";position:absolute;left:-26px;top:14px;height:2px;width:24px;border-bottom:2px solid rgba(0,0,0,.1);border-radius:0 0 0 4px}.author-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.author-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;color:var(--text-secondary)}.author-avatar.clickable-avatar[_ngcontent-%COMP%]{cursor:pointer;transition:transform .2s ease,opacity .2s ease,box-shadow .2s ease;position:relative}.author-avatar.clickable-avatar[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;border-radius:50%;box-shadow:0 0 0 2px transparent;transition:box-shadow .2s ease}.author-avatar.clickable-avatar[_ngcontent-%COMP%]:hover{transform:scale(1.05);opacity:.9}.author-avatar.clickable-avatar[_ngcontent-%COMP%]:hover:after{box-shadow:0 0 0 2px var(--primary-color)}.author-avatar.clickable-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .author-avatar.clickable-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer}.author-details[_ngcontent-%COMP%]{display:flex;flex-direction:column}.author-name[_ngcontent-%COMP%]{font-weight:500}.author-name.clickable-name[_ngcontent-%COMP%]{color:var(--primary-color);cursor:pointer;position:relative;display:inline-block;transition:color .2s ease}.author-name.clickable-name[_ngcontent-%COMP%]:after{content:"";position:absolute;width:100%;height:1px;bottom:-2px;left:0;background-color:var(--primary-color);transform:scaleX(0);transform-origin:bottom left;transition:transform .2s ease}.author-name.clickable-name[_ngcontent-%COMP%]:hover{color:var(--primary-darker)}.author-name.clickable-name[_ngcontent-%COMP%]:hover:after{transform:scaleX(1)}.comment-date[_ngcontent-%COMP%]{font-size:.8rem;color:var(--text-secondary)}.comment-content[_ngcontent-%COMP%]{white-space:pre-wrap;margin-bottom:8px;word-break:break-word}.comment-content.deleted[_ngcontent-%COMP%]{font-style:italic;color:var(--text-secondary)}.edit-timestamp[_ngcontent-%COMP%]{font-size:.8rem;color:var(--text-secondary);font-style:italic;margin-top:4px}.status-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:12px;font-size:.8rem;margin-right:8px}.badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:12px;font-size:.8rem}.badge-pending[_ngcontent-%COMP%]{background-color:#ffc107;color:#000}.badge-flagged[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.reply-form[_ngcontent-%COMP%]{padding-left:16px;border-left:2px solid var(--primary-lighter);margin-bottom:16px}.replies-section[_ngcontent-%COMP%]{margin-top:8px}.replies-loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:16px}.replies-container[_ngcontent-%COMP%], .toggle-replies[_ngcontent-%COMP%]{margin-top:8px}.reply-count-link[_ngcontent-%COMP%]{color:var(--primary-color);text-decoration:none;cursor:pointer;font-weight:500}.reply-count-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.load-more[_ngcontent-%COMP%]{margin-top:8px;display:flex;justify-content:center}']})}return i})(),St=(()=>{class i{elementRef;scrollThreshold=100;scrolled=new t.bkB;observer=null;intersectionElement;constructor(e){this.elementRef=e,this.intersectionElement=document.createElement("div"),this.intersectionElement.style.height="1px",this.intersectionElement.style.width="100%",this.intersectionElement.style.position="absolute",this.intersectionElement.style.bottom=`${this.scrollThreshold}px`,this.intersectionElement.className="infinite-scroll-sentinel"}ngOnInit(){"absolute"!==this.elementRef.nativeElement.style.position&&"fixed"!==this.elementRef.nativeElement.style.position&&"relative"!==this.elementRef.nativeElement.style.position&&(this.elementRef.nativeElement.style.position="relative"),this.elementRef.nativeElement.appendChild(this.intersectionElement),this.observer=new IntersectionObserver(e=>{e.forEach(o=>{o.isIntersecting&&this.scrolled.emit()})},{root:null,rootMargin:"0px",threshold:.1}),this.observer.observe(this.intersectionElement)}ngOnDestroy(){this.observer&&(this.observer.disconnect(),this.observer=null),this.intersectionElement.parentNode&&this.intersectionElement.parentNode.removeChild(this.intersectionElement)}static \u0275fac=function(o){return new(o||i)(t.rXU(t.aKT))};static \u0275dir=t.FsC({type:i,selectors:[["","appInfiniteScroll",""]],inputs:{scrollThreshold:"scrollThreshold"},outputs:{scrolled:"scrolled"}})}return i})();const Lt=["commentsContainer"];function $t(i,r){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.SpI("(",e.totalComments(),")")}}function Vt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",10)(1,"app-comment-form",11),t.bIt("commentAdded",function(n){t.eBV(e);const a=t.XpG(2);return t.Njj(a.onCommentAdded(n))})("cancelEdit",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.hideCommentForm())}),t.k0s()()}if(2&i){const e=t.XpG(2);t.R7$(),t.Y8G("postId",e.postId)("autoFocus",!0)}}function Ot(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",12)(1,"button",13),t.bIt("click",function(n){t.eBV(e);const a=t.XpG(2);return t.Njj(a.showCommentFormTrigger(n))}),t.j41(2,"mat-icon"),t.EFF(3,"comment"),t.k0s(),t.EFF(4," Leave a comment "),t.k0s()()}}function Bt(i,r){if(1&i&&(t.j41(0,"div",7),t.DNE(1,Vt,2,2,"div",8)(2,Ot,5,0,"div",9),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("ngIf",e.showCommentForm()),t.R7$(),t.Y8G("ngIf",!e.showCommentForm())}}function Ut(i,r){1&i&&(t.j41(0,"div",14)(1,"p"),t.EFF(2,"Please "),t.j41(3,"a",15),t.EFF(4,"login"),t.k0s(),t.EFF(5," to leave a comment."),t.k0s()())}function Xt(i,r){1&i&&t.eu8(0)}function Nt(i,r){1&i&&(t.j41(0,"div",25),t.nrm(1,"mat-spinner",26),t.k0s())}function Yt(i,r){1&i&&(t.j41(0,"div",27)(1,"p"),t.EFF(2,"No pending comments."),t.k0s()())}function zt(i,r){if(1&i){const e=t.RV6();t.j41(0,"app-comment-item",31),t.bIt("commentDeleted",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onCommentDeleted(n))})("commentUpdated",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onCommentUpdated(n))})("replyAdded",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onReplyAdded(n))}),t.k0s()}if(2&i){const e=r.$implicit,o=t.XpG(3);t.Y8G("comment",e)("postId",o.postId)("maxDepth",o.maxDepth)}}function Wt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",32)(1,"button",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.loadMorePending())}),t.EFF(2," Load More "),t.k0s()()}}function Qt(i,r){if(1&i&&(t.j41(0,"div",28),t.DNE(1,zt,1,3,"app-comment-item",29)(2,Wt,3,0,"div",30),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngForOf",e.pendingComments()),t.R7$(),t.Y8G("ngIf",e.hasMorePending()&&!e.loadingMore())}}function Ht(i,r){1&i&&(t.j41(0,"div",25),t.nrm(1,"mat-spinner",26),t.k0s())}function Jt(i,r){1&i&&(t.j41(0,"div",27)(1,"p"),t.EFF(2,"No flagged comments."),t.k0s()())}function qt(i,r){if(1&i){const e=t.RV6();t.j41(0,"app-comment-item",31),t.bIt("commentDeleted",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onCommentDeleted(n))})("commentUpdated",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onCommentUpdated(n))})("replyAdded",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onReplyAdded(n))}),t.k0s()}if(2&i){const e=r.$implicit,o=t.XpG(3);t.Y8G("comment",e)("postId",o.postId)("maxDepth",o.maxDepth)}}function Kt(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",32)(1,"button",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG(3);return t.Njj(n.loadMoreFlagged())}),t.EFF(2," Load More "),t.k0s()()}}function Zt(i,r){if(1&i&&(t.j41(0,"div",28),t.DNE(1,qt,1,3,"app-comment-item",29)(2,Kt,3,0,"div",30),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngForOf",e.flaggedComments()),t.R7$(),t.Y8G("ngIf",e.hasMoreFlagged()&&!e.loadingMore())}}function te(i,r){if(1&i){const e=t.RV6();t.j41(0,"mat-tab-group",16),t.bIt("selectedTabChange",function(n){t.eBV(e);const a=t.XpG();return t.Njj(a.onTabChange(n))}),t.j41(1,"mat-tab",17),t.DNE(2,Xt,1,0,"ng-container",18),t.k0s(),t.j41(3,"mat-tab",19)(4,"div",20),t.DNE(5,Nt,2,0,"div",21)(6,Yt,3,0,"div",22)(7,Qt,3,2,"div",23),t.k0s()(),t.j41(8,"mat-tab",24)(9,"div",20),t.DNE(10,Ht,2,0,"div",21)(11,Jt,3,0,"div",22)(12,Zt,3,2,"div",23),t.k0s()()()}if(2&i){const e=t.XpG(),o=t.sdS(9);t.R7$(2),t.Y8G("ngTemplateOutlet",o),t.R7$(3),t.Y8G("ngIf",e.pendingLoading()),t.R7$(),t.Y8G("ngIf",!e.pendingLoading()&&0===e.pendingComments().length),t.R7$(),t.Y8G("ngIf",!e.pendingLoading()&&e.pendingComments().length>0),t.R7$(3),t.Y8G("ngIf",e.flaggedLoading()),t.R7$(),t.Y8G("ngIf",!e.flaggedLoading()&&0===e.flaggedComments().length),t.R7$(),t.Y8G("ngIf",!e.flaggedLoading()&&e.flaggedComments().length>0)}}function ee(i,r){1&i&&t.eu8(0)}function oe(i,r){if(1&i&&(t.qex(0),t.DNE(1,ee,1,0,"ng-container",18),t.bVm()),2&i){t.XpG();const e=t.sdS(9);t.R7$(),t.Y8G("ngTemplateOutlet",e)}}function ne(i,r){1&i&&(t.j41(0,"div",25),t.nrm(1,"mat-spinner",26),t.k0s())}function ie(i,r){1&i&&(t.j41(0,"div",27)(1,"p"),t.EFF(2,"No comments yet. Be the first to comment!"),t.k0s()())}function ae(i,r){if(1&i){const e=t.RV6();t.j41(0,"app-comment-item",31),t.bIt("commentDeleted",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onCommentDeleted(n))})("commentUpdated",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onCommentUpdated(n))})("replyAdded",function(n){t.eBV(e);const a=t.XpG(3);return t.Njj(a.onReplyAdded(n))}),t.k0s()}if(2&i){const e=r.$implicit,o=t.XpG(3);t.Y8G("comment",e)("postId",o.postId)("maxDepth",o.maxDepth)}}function re(i,r){1&i&&(t.j41(0,"div",36),t.nrm(1,"mat-spinner",37),t.k0s())}function se(i,r){if(1&i&&(t.j41(0,"div",28),t.DNE(1,ae,1,3,"app-comment-item",29)(2,re,2,0,"div",35),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngForOf",e.comments()),t.R7$(),t.Y8G("ngIf",e.loadingMore())}}function ce(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",34),t.bIt("scrolled",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.onScroll())}),t.DNE(1,ne,2,0,"div",21)(2,ie,3,0,"div",22)(3,se,3,2,"div",23),t.k0s()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("ngIf",e.loading()),t.R7$(),t.Y8G("ngIf",!e.loading()&&0===e.comments().length),t.R7$(),t.Y8G("ngIf",!e.loading()&&e.comments().length>0)}}let me=(()=>{class i{commentService=(0,t.WQX)(m.j);authService=(0,t.WQX)(A.u);postId;maxDepth=10;commentsContainer;_showCommentForm=(0,t.vPA)(!1);showCommentForm=this._showCommentForm.asReadonly();comments=(0,t.vPA)([]);loading=(0,t.vPA)(!0);loadingMore=(0,t.vPA)(!1);hasMore=(0,t.vPA)(!1);totalComments=(0,t.vPA)(0);lastVisible=null;pendingComments=(0,t.vPA)([]);flaggedComments=(0,t.vPA)([]);pendingLoading=(0,t.vPA)(!1);flaggedLoading=(0,t.vPA)(!1);hasMorePending=(0,t.vPA)(!1);hasMoreFlagged=(0,t.vPA)(!1);pendingLastVisible=null;flaggedLastVisible=null;activeTab=0;commentsSubscription;ngOnInit(){this.loadComments(),this.isAdmin()&&this.loadPendingComments()}ngAfterViewInit(){}ngOnDestroy(){this.commentService.clearCache(),this.commentsSubscription&&this.commentsSubscription.unsubscribe()}isLoggedIn(){return!!this.authService.currentUser()}isAdmin(){return"admin"===this.authService.profile()?.role}loadComments(){var e=this;return(0,h.A)(function*(){try{e.loading.set(!0);const o=yield e.commentService.loadCommentsForPost(e.postId),n=o.filter(a=>!a.parentId);e.comments.set(n),e.totalComments.set(o.length),e.commentsSubscription=e.commentService.comments$.subscribe(a=>{const d=a.filter(_=>!_.parentId);e.comments.set(d),e.totalComments.set(a.length)})}catch(o){console.error("Error loading comments:",o)}finally{e.loading.set(!1)}})()}loadMoreComments(){var e=this;return(0,h.A)(function*(){if(e.hasMore()&&!e.loadingMore()&&e.lastVisible)try{e.loadingMore.set(!0);const{comments:o,lastVisible:n}=yield e.commentService.getTopLevelComments(e.postId,e.lastVisible);e.comments.update(a=>[...a,...o]),e.lastVisible=n,e.hasMore.set(o.length>=10),e.totalComments.update(a=>a+o.length)}catch(o){console.error("Error loading more comments:",o)}finally{e.loadingMore.set(!1)}})()}loadPendingComments(){var e=this;return(0,h.A)(function*(){if(e.isAdmin())try{e.pendingLoading.set(!0);const o=yield e.commentService.getPendingComments(),n=o.comments.filter(a=>a.postId===e.postId);e.pendingComments.set(n),e.pendingLastVisible=o.lastVisible,e.hasMorePending.set(o.comments.length>=10)}catch(o){console.error("Error loading pending comments:",o)}finally{e.pendingLoading.set(!1)}})()}loadMorePending(){var e=this;return(0,h.A)(function*(){if(e.isAdmin()&&e.pendingLastVisible&&!e.loadingMore())try{e.loadingMore.set(!0);const o=yield e.commentService.getPendingComments(e.pendingLastVisible),n=o.comments.filter(a=>a.postId===e.postId);e.pendingComments.update(a=>[...a,...n]),e.pendingLastVisible=o.lastVisible,e.hasMorePending.set(o.comments.length>=10)}catch(o){console.error("Error loading more pending comments:",o)}finally{e.loadingMore.set(!1)}})()}loadFlaggedComments(){var e=this;return(0,h.A)(function*(){if(e.isAdmin())try{e.flaggedLoading.set(!0);const o=yield e.commentService.getFlaggedComments(),n=o.comments.filter(a=>a.postId===e.postId);e.flaggedComments.set(n),e.flaggedLastVisible=o.lastVisible,e.hasMoreFlagged.set(o.comments.length>=10)}catch(o){console.error("Error loading flagged comments:",o)}finally{e.flaggedLoading.set(!1)}})()}loadMoreFlagged(){var e=this;return(0,h.A)(function*(){if(e.isAdmin()&&e.flaggedLastVisible&&!e.loadingMore())try{e.loadingMore.set(!0);const o=yield e.commentService.getFlaggedComments(e.flaggedLastVisible),n=o.comments.filter(a=>a.postId===e.postId);e.flaggedComments.update(a=>[...a,...n]),e.flaggedLastVisible=o.lastVisible,e.hasMoreFlagged.set(o.comments.length>=10)}catch(o){console.error("Error loading more flagged comments:",o)}finally{e.loadingMore.set(!1)}})()}showCommentFormTrigger(e){e.stopPropagation(),console.log("Showing comment form - stopped propagation"),this._showCommentForm.set(!0)}hideCommentForm(){console.log("Hiding comment form"),this._showCommentForm.set(!1)}onCommentAdded(e){e.parentId||(this.comments.update(o=>[e,...o]),this.totalComments.update(o=>o+1),this.hideCommentForm())}onCommentDeleted(e){this.comments.update(o=>o.filter(n=>n.id!==e)),this.totalComments.update(o=>Math.max(0,o-1)),this.isAdmin()&&(this.pendingComments.update(o=>o.filter(n=>n.id!==e)),this.flaggedComments.update(o=>o.filter(n=>n.id!==e)))}onCommentUpdated(e){e.parentId||this.comments.update(o=>o.map(n=>n.id===e.id?e:n)),this.isAdmin()&&("approved"===e.status?(this.pendingComments.update(o=>o.filter(n=>n.id!==e.id)),this.flaggedComments.update(o=>o.filter(n=>n.id!==e.id))):"flagged"===e.status?(this.pendingComments.update(o=>o.filter(n=>n.id!==e.id)),this.flaggedComments.update(o=>{const n=o.findIndex(a=>a.id===e.id);return n>=0?[...o.slice(0,n),e,...o.slice(n+1)]:[e,...o]})):"pending"===e.status&&(this.flaggedComments.update(o=>o.filter(n=>n.id!==e.id)),this.pendingComments.update(o=>{const n=o.findIndex(a=>a.id===e.id);return n>=0?[...o.slice(0,n),e,...o.slice(n+1)]:[e,...o]})))}onReplyAdded(e){this.totalComments.update(o=>o+1)}onTabChange(e){this.activeTab=e.index,1!==this.activeTab||0!==this.pendingComments().length||this.pendingLoading()?2===this.activeTab&&0===this.flaggedComments().length&&!this.flaggedLoading()&&this.loadFlaggedComments():this.loadPendingComments()}onScroll(){0===this.activeTab?this.loadMoreComments():1===this.activeTab?this.loadMorePending():2===this.activeTab&&this.loadMoreFlagged()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=t.VBU({type:i,selectors:[["app-comment-list"]],viewQuery:function(o,n){if(1&o&&t.GBs(Lt,5),2&o){let a;t.mGM(a=t.lsd())&&(n.commentsContainer=a.first)}},inputs:{postId:"postId",maxDepth:"maxDepth"},decls:10,vars:5,consts:[["commentsList",""],[1,"comments-container"],[1,"comments-header"],[4,"ngIf"],["class","comment-form-wrapper",4,"ngIf"],["class","login-prompt",4,"ngIf"],[3,"selectedTabChange",4,"ngIf"],[1,"comment-form-wrapper"],["class","comment-form-container",4,"ngIf"],["class","comment-trigger",4,"ngIf"],[1,"comment-form-container"],[3,"commentAdded","cancelEdit","postId","autoFocus"],[1,"comment-trigger"],["mat-stroked-button","","color","primary",3,"click"],[1,"login-prompt"],["routerLink","/auth/login"],[3,"selectedTabChange"],["label","All"],[4,"ngTemplateOutlet"],["label","Pending"],[1,"tab-content"],["class","loading-container",4,"ngIf"],["class","empty-message",4,"ngIf"],["class","comments-list",4,"ngIf"],["label","Flagged"],[1,"loading-container"],["diameter","40"],[1,"empty-message"],[1,"comments-list"],[3,"comment","postId","maxDepth","commentDeleted","commentUpdated","replyAdded",4,"ngFor","ngForOf"],["class","load-more",4,"ngIf"],[3,"commentDeleted","commentUpdated","replyAdded","comment","postId","maxDepth"],[1,"load-more"],["mat-button","","color","primary",3,"click"],["appInfiniteScroll","",1,"comments-list-container",3,"scrolled"],["class","load-more-indicator",4,"ngIf"],[1,"load-more-indicator"],["diameter","30"]],template:function(o,n){1&o&&(t.j41(0,"div",1)(1,"h2",2),t.EFF(2," Comments "),t.DNE(3,$t,2,1,"span",3),t.k0s(),t.DNE(4,Bt,3,2,"div",4)(5,Ut,6,0,"div",5)(6,te,13,7,"mat-tab-group",6)(7,oe,2,1,"ng-container",3)(8,ce,4,3,"ng-template",null,0,t.C5r),t.k0s()),2&o&&(t.R7$(3),t.Y8G("ngIf",n.totalComments()>0),t.R7$(),t.Y8G("ngIf",n.isLoggedIn()),t.R7$(),t.Y8G("ngIf",!n.isLoggedIn()),t.R7$(),t.Y8G("ngIf",n.isAdmin()),t.R7$(),t.Y8G("ngIf",!n.isAdmin()))},dependencies:[v.MD,v.Sq,v.bT,v.T3,j.iI,j.Wk,E.Hu,C.Hl,C.$z,D.m_,D.An,x.w,F.D6,F.LG,c.RI,c.mq,c.T8,At,N,St],styles:[".comments-container[_ngcontent-%COMP%]{margin-top:32px}.comments-header[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:16px;border-bottom:1px solid var(--border-color);padding-bottom:8px}.comment-form-wrapper[_ngcontent-%COMP%]{margin-bottom:24px}.comment-trigger[_ngcontent-%COMP%]{display:flex;margin-bottom:16px}.comment-trigger[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px}.login-prompt[_ngcontent-%COMP%]{padding:16px;text-align:center;background-color:var(--surface-color);border-radius:4px;margin-bottom:24px}.comments-list-container[_ngcontent-%COMP%]{position:relative;min-height:100px}.comments-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:32px}.empty-message[_ngcontent-%COMP%]{text-align:center;padding:32px;color:var(--text-secondary)}.load-more[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:16px}.load-more-indicator[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:16px}.tab-content[_ngcontent-%COMP%]{padding:16px 0}"]})}return i})();function de(i,r){if(1&i&&(t.j41(0,"div",19),t.nrm(1,"img",20),t.k0s()),2&i){const e=t.XpG();t.R7$(),t.Y8G("src",e.shareData.image,t.B4B)("alt",e.shareData.title)}}function le(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",21)(1,"h3"),t.EFF(2,"Embed Code"),t.k0s(),t.j41(3,"div",22)(4,"pre"),t.EFF(5),t.k0s()(),t.j41(6,"button",23),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.copyEmbedCode())}),t.j41(7,"mat-icon"),t.EFF(8,"content_copy"),t.k0s(),t.EFF(9," Copy Embed Code "),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(5),t.JRh(e.embedHtml)}}let pe=(()=>{class i{dialogRef;data;shareService;snackBar;sanitizer;shareData;embedHtml;constructor(e,o,n,a,d){this.dialogRef=e,this.data=o,this.shareService=n,this.snackBar=a,this.sanitizer=d,this.shareData=o.shareData,this.embedHtml=this.createEmbedCode()}shareToFacebook(){this.shareService.shareToFacebook(this.shareData)}shareToTwitter(){this.shareService.shareToTwitter(this.shareData)}shareToLinkedIn(){this.shareService.shareToLinkedIn(this.shareData)}shareViaEmail(){this.shareService.shareViaEmail(this.shareData)}copyLink(){var e=this;return(0,h.A)(function*(){try{(yield e.shareService.copyLinkToClipboard(e.shareData))?e.snackBar.open("Link copied to clipboard","Close",{duration:3e3}):e.snackBar.open("Failed to copy link","Close",{duration:3e3})}catch(o){console.error("Error copying link:",o),e.snackBar.open("Failed to copy link","Close",{duration:3e3})}})()}copyEmbedCode(){var e=this;return(0,h.A)(function*(){try{yield navigator.clipboard.writeText(e.embedHtml),e.snackBar.open("Embed code copied to clipboard","Close",{duration:3e3})}catch(o){console.error("Failed to copy embed code:",o),e.snackBar.open("Failed to copy embed code","Close",{duration:3e3})}})()}createEmbedCode(){return`<div style="border: 1px solid #ddd; border-radius: 8px; max-width: 500px; font-family: Arial, sans-serif;">\n  ${this.shareData.image?`<img src="${this.shareData.image}" alt="${this.shareData.title}" style="width: 100%; border-radius: 8px 8px 0 0; object-fit: cover; height: 250px;" />`:""}\n  <div style="padding: 16px;">\n    <h2 style="margin-top: 0; color: #333;">${this.shareData.title}</h2>\n    <p style="color: #666;">${this.shareData.description}</p>\n    <a href="${this.shareData.url}" style="display: inline-block; padding: 8px 16px; background-color: #007bff; color: white; text-decoration: none; border-radius: 4px; margin-top: 12px;">Read More</a>\n  </div>\n</div>`}close(){this.dialogRef.close()}static \u0275fac=function(o){return new(o||i)(t.rXU(f.CP),t.rXU(f.Vh),t.rXU(L),t.rXU(w.UG),t.rXU(u.up))};static \u0275cmp=t.VBU({type:i,selectors:[["app-share-dialog"]],decls:41,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"share-preview"],[1,"preview-header"],[1,"preview-card"],["class","preview-image",4,"ngIf"],[1,"preview-content"],[1,"preview-title"],[1,"preview-description"],[1,"preview-meta"],[1,"share-options"],["mat-raised-button","","color","primary",1,"share-button","facebook",3,"click"],["mat-raised-button","","color","primary",1,"share-button","twitter",3,"click"],["mat-raised-button","","color","primary",1,"share-button","linkedin",3,"click"],["mat-raised-button","","color","primary",1,"share-button","email",3,"click"],["mat-raised-button","",1,"share-button","copy",3,"click"],["class","embed-code",4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-button","",3,"click"],[1,"preview-image"],[3,"src","alt"],[1,"embed-code"],[1,"code-container"],["mat-button","","color","primary",3,"click"]],template:function(o,n){1&o&&(t.j41(0,"h2",0),t.EFF(1,"Share This Post"),t.k0s(),t.j41(2,"div",1)(3,"div",2)(4,"div",3),t.EFF(5,"Preview"),t.k0s(),t.j41(6,"div",4),t.DNE(7,de,2,2,"div",5),t.j41(8,"div",6)(9,"h3",7),t.EFF(10),t.k0s(),t.j41(11,"p",8),t.EFF(12),t.k0s(),t.j41(13,"div",9)(14,"span"),t.EFF(15),t.k0s()()()()(),t.j41(16,"div",10)(17,"button",11),t.bIt("click",function(){return n.shareToFacebook()}),t.j41(18,"mat-icon"),t.EFF(19,"facebook"),t.k0s(),t.EFF(20," Share on Facebook "),t.k0s(),t.j41(21,"button",12),t.bIt("click",function(){return n.shareToTwitter()}),t.j41(22,"mat-icon"),t.EFF(23,"twitter"),t.k0s(),t.EFF(24," Share on Twitter "),t.k0s(),t.j41(25,"button",13),t.bIt("click",function(){return n.shareToLinkedIn()}),t.j41(26,"mat-icon"),t.EFF(27,"linkedin"),t.k0s(),t.EFF(28," Share on LinkedIn "),t.k0s(),t.j41(29,"button",14),t.bIt("click",function(){return n.shareViaEmail()}),t.j41(30,"mat-icon"),t.EFF(31,"email"),t.k0s(),t.EFF(32," Share via Email "),t.k0s(),t.j41(33,"button",15),t.bIt("click",function(){return n.copyLink()}),t.j41(34,"mat-icon"),t.EFF(35,"content_copy"),t.k0s(),t.EFF(36," Copy Link "),t.k0s()(),t.DNE(37,le,10,1,"div",16),t.k0s(),t.j41(38,"div",17)(39,"button",18),t.bIt("click",function(){return n.close()}),t.EFF(40,"Close"),t.k0s()()),2&o&&(t.R7$(7),t.Y8G("ngIf",n.shareData.image),t.R7$(3),t.JRh(n.shareData.title),t.R7$(2),t.JRh(n.shareData.description),t.R7$(3),t.JRh(n.shareData.siteName||"Blog App"),t.R7$(22),t.Y8G("ngIf",n.embedHtml))},dependencies:[v.MD,v.bT,f.hM,f.BI,f.E7,f.Yi,C.Hl,C.$z,D.m_,D.An,w._T],styles:[".share-preview[_ngcontent-%COMP%]{margin-bottom:20px}.preview-header[_ngcontent-%COMP%]{font-size:14px;color:#666;margin-bottom:8px}.preview-card[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:8px;overflow:hidden;box-shadow:0 2px 4px #0000001a}.preview-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:200px;object-fit:cover}.preview-content[_ngcontent-%COMP%]{padding:16px}.preview-title[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:500}.preview-description[_ngcontent-%COMP%]{margin:0 0 8px;font-size:14px;color:#666;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.preview-meta[_ngcontent-%COMP%]{font-size:12px;color:#888}.share-options[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px;margin-bottom:20px}.share-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px}.facebook[_ngcontent-%COMP%]{background-color:#1877f2;color:#fff}.twitter[_ngcontent-%COMP%]{background-color:#1da1f2;color:#fff}.linkedin[_ngcontent-%COMP%]{background-color:#0077b5;color:#fff}.email[_ngcontent-%COMP%]{background-color:#ea4335;color:#fff}.copy[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#333}.embed-code[_ngcontent-%COMP%]{margin-top:20px}.code-container[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:12px;border-radius:4px;max-height:100px;overflow-y:auto;margin-bottom:12px}pre[_ngcontent-%COMP%]{white-space:pre-wrap;word-wrap:break-word;margin:0;font-size:12px}"]})}return i})(),ue=(()=>{class i{meta;title;document;constructor(e,o,n){this.meta=e,this.title=o,this.document=n}setOpenGraphTags(e){this.title.setTitle(e.title),this.meta.updateTag({name:"description",content:e.description||""}),this.meta.updateTag({property:"og:title",content:e.title}),this.meta.updateTag({property:"og:description",content:e.description||""}),this.meta.updateTag({property:"og:url",content:e.url}),this.meta.updateTag({property:"og:type",content:"article"}),e.image&&(this.meta.updateTag({property:"og:image",content:e.image}),this.meta.updateTag({property:"og:image:alt",content:e.title})),this.meta.updateTag({name:"twitter:card",content:"summary_large_image"}),this.meta.updateTag({name:"twitter:title",content:e.title}),this.meta.updateTag({name:"twitter:description",content:e.description||""}),e.image&&this.meta.updateTag({name:"twitter:image",content:e.image}),e.tags&&e.tags.length>0&&e.tags.forEach((o,n)=>{this.meta.updateTag({property:"article:tag",content:o})}),this.updateCanonicalUrl(e.url)}clearOpenGraphTags(){this.meta.removeTag('property="og:title"'),this.meta.removeTag('property="og:description"'),this.meta.removeTag('property="og:url"'),this.meta.removeTag('property="og:type"'),this.meta.removeTag('property="og:image"'),this.meta.removeTag('property="og:image:alt"'),this.meta.removeTag('name="twitter:card"'),this.meta.removeTag('name="twitter:title"'),this.meta.removeTag('name="twitter:description"'),this.meta.removeTag('name="twitter:image"'),this.meta.removeTag('property="article:tag"'),this.removeCanonicalUrl()}updateCanonicalUrl(e){this.removeCanonicalUrl();const o=this.document.createElement("link");o.setAttribute("rel","canonical"),o.setAttribute("href",e),this.document.head.appendChild(o)}removeCanonicalUrl(){const e=this.document.querySelector('link[rel="canonical"]');e&&e.remove()}static \u0275fac=function(o){return new(o||i)(t.KVO(u.W8),t.KVO(u.hE),t.KVO(v.qQ))};static \u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();const _e=()=>["/blog"],he=i=>({tag:i}),ge=i=>["/blog",i,"edit"],fe=i=>["/blog",i],be=(i,r)=>r.id;function ve(i,r){1&i&&(t.j41(0,"div",1),t.nrm(1,"mat-spinner",3),t.k0s())}function Ce(i,r){1&i&&(t.j41(0,"div",2)(1,"h2"),t.EFF(2,"Post not found"),t.k0s(),t.j41(3,"p"),t.EFF(4,"The post you are looking for does not exist or has been removed."),t.k0s(),t.j41(5,"a",4),t.EFF(6,"Back to Posts"),t.k0s()())}function ke(i,r){if(1&i&&t.nrm(0,"img",9),2&i){let e;const o=t.XpG(2);t.Y8G("src",null==(e=o.post())?null:e.authorPhotoURL,t.B4B)}}function ye(i,r){1&i&&(t.j41(0,"mat-icon",10),t.EFF(1,"account_circle"),t.k0s())}function xe(i,r){if(1&i&&(t.j41(0,"mat-chip",23),t.EFF(1),t.k0s()),2&i){const e=r.$implicit;t.Y8G("routerLink",t.lJ4(3,_e))("queryParams",t.eq3(4,he,e)),t.R7$(),t.JRh(e)}}function Ie(i,r){if(1&i&&(t.j41(0,"div",12),t.Z7z(1,xe,2,6,"mat-chip",23,t.fX1),t.k0s()),2&i){let e;const o=t.XpG(2);t.R7$(),t.Dyx(null==(e=o.post())?null:e.tags)}}function Ee(i,r){if(1&i&&(t.j41(0,"div",13)(1,"a",24)(2,"mat-icon"),t.EFF(3,"edit"),t.k0s(),t.EFF(4," Edit Post "),t.k0s()()),2&i){let e;const o=t.XpG(2);t.R7$(),t.Y8G("routerLink",t.eq3(1,ge,null==(e=o.post())?null:e.id))}}function Fe(i,r){if(1&i&&(t.j41(0,"div",14),t.nrm(1,"img",25),t.k0s()),2&i){let e,o;const n=t.XpG(2);t.R7$(),t.FS9("alt",null==(e=n.post())?null:e.title),t.Y8G("src",null==(o=n.post())?null:o.imageUrl,t.B4B)}}function Re(i,r){if(1&i&&t.nrm(0,"pre",26),2&i){const e=t.XpG().$implicit;t.Y8G("appCodeHighlight",e.language||"plaintext")("code",e.content)}}function Te(i,r){if(1&i&&t.nrm(0,"div",27),2&i){const e=t.XpG().$implicit;t.Y8G("innerHTML",e.html,t.npT)}}function De(i,r){1&i&&t.DNE(0,Re,1,2,"pre",26)(1,Te,1,1,"div",27),2&i&&t.vxM("code"===r.$implicit.type?0:1)}function je(i,r){if(1&i&&t.nrm(0,"img",30),2&i){const e=t.XpG().$implicit;t.FS9("alt",e.title),t.Y8G("src",e.imageUrl,t.B4B)}}function Ge(i,r){if(1&i&&(t.j41(0,"mat-card",29),t.DNE(1,je,1,2,"img",30),t.j41(2,"mat-card-content")(3,"h3"),t.EFF(4),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s()()()),2&i){const e=r.$implicit,o=t.XpG(3);t.Y8G("routerLink",t.eq3(4,fe,e.id)),t.R7$(),t.vxM(e.imageUrl?1:-1),t.R7$(3),t.JRh(e.title),t.R7$(2),t.JRh(o.generateExcerpt(e))}}function we(i,r){if(1&i&&(t.j41(0,"div",20)(1,"h2"),t.EFF(2,"Related Posts"),t.k0s(),t.j41(3,"div",28),t.Z7z(4,Ge,7,6,"mat-card",29,be),t.k0s()()),2&i){const e=t.XpG(2);t.R7$(4),t.Dyx(e.relatedPosts())}}function Pe(i,r){if(1&i){const e=t.RV6();t.j41(0,"div",5)(1,"h1",6),t.EFF(2),t.k0s(),t.j41(3,"div",7)(4,"div",8),t.DNE(5,ke,1,1,"img",9)(6,ye,2,0,"mat-icon",10),t.j41(7,"span"),t.EFF(8),t.k0s()(),t.j41(9,"div",11)(10,"mat-icon"),t.EFF(11,"calendar_today"),t.k0s(),t.j41(12,"span"),t.EFF(13),t.k0s()()(),t.DNE(14,Ie,3,0,"div",12)(15,Ee,5,3,"div",13),t.k0s(),t.DNE(16,Fe,2,2,"div",14),t.j41(17,"mat-card",15)(18,"mat-card-content")(19,"div",16),t.Z7z(20,De,2,1,null,null,t.Vm6),t.k0s()(),t.nrm(22,"mat-divider",17),t.j41(23,"mat-card-actions")(24,"button",18),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.likePost())}),t.j41(25,"mat-icon"),t.EFF(26),t.k0s(),t.EFF(27),t.k0s(),t.j41(28,"button",19),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.sharePost())}),t.j41(29,"mat-icon"),t.EFF(30,"share"),t.k0s(),t.EFF(31," Share "),t.k0s()()(),t.DNE(32,we,6,0,"div",20),t.j41(33,"div",21),t.nrm(34,"app-comment-list",22),t.k0s()}if(2&i){let e,o,n,a,d,_,G,$;const y=t.XpG();t.R7$(2),t.JRh(null==(e=y.post())?null:e.title),t.R7$(3),t.vxM(null!=(o=y.post())&&o.authorPhotoURL?5:6),t.R7$(3),t.JRh(null==(n=y.post())?null:n.authorName),t.R7$(5),t.JRh(y.formatDate(null==(a=y.post())?null:a.publishedAt)),t.R7$(),t.vxM(null!=(d=y.post())&&null!=d.tags&&d.tags.length?14:-1),t.R7$(),t.vxM(y.isAuthor()?15:-1),t.R7$(),t.vxM(null!=(_=y.post())&&_.imageUrl?16:-1),t.R7$(4),t.Dyx(y.contentBlocks()),t.R7$(4),t.Y8G("disabled",y.liking()),t.R7$(2),t.JRh(y.liked()?"favorite":"favorite_border"),t.R7$(),t.SpI(" Like (",(null==(G=y.post())?null:G.likes)||0,") "),t.R7$(),t.Y8G("disabled",y.sharing()),t.R7$(4),t.vxM(y.relatedPosts().length>0?32:-1),t.R7$(2),t.Y8G("postId",(null==($=y.post())?null:$.id)||"")}}let Me=(()=>{class i{route=(0,t.WQX)(j.nX);blogService=(0,t.WQX)(O.c);authService=(0,t.WQX)(A.u);sanitizer=(0,t.WQX)(u.up);dialog=(0,t.WQX)(f.bZ);snackBar=(0,t.WQX)(w.UG);shareService=(0,t.WQX)(L);openGraphService=(0,t.WQX)(ue);loading=(0,t.vPA)(!0);post=(0,t.vPA)(null);contentBlocks=(0,t.vPA)([]);relatedPosts=(0,t.vPA)([]);liked=(0,t.vPA)(!1);liking=(0,t.vPA)(!1);sharing=(0,t.vPA)(!1);ngOnInit(){this.route.paramMap.subscribe(e=>{const o=e.get("id");o&&this.loadPost(o)})}ngOnDestroy(){this.openGraphService.clearOpenGraphTags()}loadPost(e){var o=this;return(0,h.A)(function*(){o.loading.set(!0);try{const n=yield o.blogService.getPostById(e);if(n&&(o.post.set(n),o.setOpenGraphTags(n),setTimeout(()=>{o.setOpenGraphTags(n)},1e3),o.parseContent(n.content),n.tags&&n.tags.length>0)){const a=yield o.blogService.getRelatedPosts(e,n.tags,3);o.relatedPosts.set(a)}}catch(n){console.error("Error loading post:",n)}finally{o.loading.set(!1)}})()}setOpenGraphTags(e){if(!e)return;const o=this.shareService.getShareDataFromPost(e);console.log(o),this.openGraphService.setOpenGraphTags(o)}parseContent(e){const o=[],n=/<pre data-language="(\w+)"><code class="language-(\w+)">([\s\S]*?)<\/code><\/pre>/g;let d,a=0;for(;null!==(d=n.exec(e));){if(d.index>a){const G=e.substring(a,d.index);o.push({type:"text",content:G,html:this.sanitizer.bypassSecurityTrustHtml(G)})}const _=d[1]||d[2]||"plaintext";o.push({type:"code",content:this.unescapeHtml(d[3]),language:_}),a=d.index+d[0].length}if(a<e.length){const _=e.substring(a);o.push({type:"text",content:_,html:this.sanitizer.bypassSecurityTrustHtml(_)})}this.contentBlocks.set(o)}unescapeHtml(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'")}isAuthor(){const e=this.authService.currentUser();return!!e&&e.uid===this.post()?.authorId}formatDate(e){return e?(e.toDate?e.toDate():new Date(e)).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}):""}generateExcerpt(e){if(e.excerpt)return e.excerpt;const o=e.content.replace(/<[^>]*>/g,"");return o.substring(0,150)+(o.length>150?"...":"")}likePost(){var e=this;return(0,h.A)(function*(){const o=e.post();if(o&&o.id){e.liking.set(!0);try{yield e.blogService.likePost(o.id),e.liked.update(a=>!a);const n=(o.likes||0)+(e.liked()?1:-1);e.post.set({...o,likes:n})}catch(n){console.error("Error liking post:",n),e.snackBar.open("Failed to like post","Close",{duration:3e3})}finally{e.liking.set(!1)}}})()}sharePost(){const e=this.post();if(e){this.sharing.set(!0);try{const o=this.shareService.getShareDataFromPost(e);navigator.share?this.openShareDialog(o):navigator.share({title:o.title,text:o.description,url:o.url}).catch(n=>{console.error("Error sharing:",n),this.openShareDialog(o)})}catch(o){console.error("Error sharing post:",o),this.snackBar.open("Error sharing post","Close",{duration:3e3})}finally{this.sharing.set(!1)}}}openShareDialog(e){this.dialog.open(pe,{width:"500px",data:{shareData:e}})}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=t.VBU({type:i,selectors:[["app-post-detail"]],decls:4,vars:1,consts:[[1,"container"],[1,"loading-container"],[1,"not-found"],["diameter","40"],["mat-button","","routerLink","/blog","color","primary"],[1,"post-header"],[1,"post-title"],[1,"post-meta"],[1,"author-info"],["alt","Author",1,"author-image",3,"src"],[1,"author-icon"],[1,"post-date"],[1,"post-tags"],[1,"edit-actions"],[1,"post-image-container"],[1,"post-content-card"],[1,"post-content"],[1,"content-divider"],["mat-button","","color","primary",3,"click","disabled"],["mat-button","",3,"click","disabled"],[1,"related-posts-section"],[1,"comments-section"],[3,"postId"],[3,"routerLink","queryParams"],["mat-button","","color","primary",3,"routerLink"],[1,"post-image",3,"src","alt"],[3,"appCodeHighlight","code"],[3,"innerHTML"],[1,"related-posts-grid"],[1,"related-post-card",3,"routerLink"],[1,"related-post-image",3,"src","alt"]],template:function(o,n){1&o&&(t.j41(0,"div",0),t.DNE(1,ve,2,0,"div",1)(2,Ce,7,0,"div",2)(3,Pe,35,13),t.k0s()),2&o&&(t.R7$(),t.vxM(n.loading()?1:n.post()?3:2))},dependencies:[v.MD,j.iI,j.Wk,E.Hu,E.RN,E.YY,E.m2,C.Hl,C.It,C.$z,D.m_,D.An,V.YN,V.Jl,x.w,x.q,F.D6,F.LG,w._T,f.hM,s,me],styles:[".container{max-width:800px;margin:0 auto;padding:0 16px}.loading-container,.not-found{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;gap:16px;text-align:center}.post-header{margin-bottom:24px}.post-title{font-size:2.5rem;margin-bottom:16px;line-height:1.2}.post-meta{display:flex;align-items:center;flex-wrap:wrap;gap:16px;margin-bottom:16px;font-size:.9rem;color:var(--text-secondary)}.author-info,.post-date{display:flex;align-items:center;gap:8px}.author-image{width:32px;height:32px;border-radius:50%;object-fit:cover}.author-icon{font-size:32px;height:32px;width:32px}.post-tags{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:16px}.post-tags mat-chip{cursor:pointer}.edit-actions{margin-top:16px}.post-image-container{margin-bottom:24px;border-radius:8px;overflow:hidden;box-shadow:var(--elevation-2)}.post-image{width:100%;max-height:400px;object-fit:cover}.post-content-card{margin-bottom:32px}.post-content{font-size:1.1rem;line-height:1.7}.content-divider{margin:24px 0}.post-content pre{background-color:var(--surface-color);padding:16px;border-radius:4px;overflow-x:auto;margin:1.5rem 0;position:relative}.post-content pre:before{content:attr(data-language);position:absolute;top:0;right:0;color:var(--text-secondary);font-size:.8rem;padding:.2rem .5rem;background-color:#0000001a;border-radius:0 4px;text-transform:uppercase}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.property,.token.tag,.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#905}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#690}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function,.token.class-name{color:#dd4a68}.token.regex,.token.important,.token.variable{color:#e90}.token.important,.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.related-posts-section{margin-bottom:32px}.related-posts-section h2{font-size:1.5rem;margin-bottom:16px}.related-posts-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px}.related-post-card{cursor:pointer;transition:transform .2s ease,box-shadow .2s ease}.related-post-card:hover{transform:translateY(-4px);box-shadow:var(--elevation-3)}.related-post-image{width:100%;height:140px;object-fit:cover}.related-post-card h3{font-size:1.1rem;margin:8px 0}.related-post-card p{font-size:.9rem;color:var(--text-secondary);margin:0;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.comments-section{margin-top:32px;margin-bottom:64px}.post-content img{max-width:100%;height:auto}.post-content a{color:var(--primary-color);text-decoration:none}.post-content a:hover{text-decoration:underline}\n"],encapsulation:2})}return i})()}}]);