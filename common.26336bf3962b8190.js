"use strict";(self.webpackChunkblog_app=self.webpackChunkblog_app||[]).push([[76],{3933:(U,E,n)=>{n.d(E,{D:()=>y});var d=n(3107),a=n(4522),h=n(3756),o=n(2695),p=n(4159),l=n(8915),D=n(3016),g=n(7947),c=n(7178),u=n(2867),A=n(7082),m=n(480);let y=(()=>{class e{firestore=(0,d.WQX)(a._7);functions=(0,d.WQX)(o.ah);authService=(0,d.WQX)(A.u);errorService=(0,d.WQX)(m.I);getUsers(t=100){const i=(0,a.rJ)(this.firestore,"users"),s=(0,a.P)(i,(0,a.My)("displayName"),(0,a.AB)(t));return(0,p.H)((0,a.GG)(s)).pipe((0,g.T)(v=>v.docs.map(f=>({uid:f.id,...f.data(),isActive:f.data().isActive??!0,createdAt:f.data().createdAt?.toDate(),updatedAt:f.data().updatedAt?.toDate()}))),(0,c.W)(v=>(this.errorService.showError("Error loading users"),(0,l.$)(()=>new Error(v)))))}getUserById(t){const i=(0,a.x7)((0,a.H9)(this.firestore,"users",t));return(0,p.H)(i).pipe((0,g.T)(s=>s.exists()?{uid:s.id,...s.data(),isActive:s.data().isActive??!0,createdAt:s.data().createdAt?.toDate(),updatedAt:s.data().updatedAt?.toDate()}:null),(0,c.W)(s=>(this.errorService.showError("Error loading user details"),(0,l.$)(()=>new Error(s)))))}updateUserRole(t,i){return this.authService.profile$.pipe((0,u.n)(s=>{if(!s||"admin"!==s.role)return this.errorService.showError("Permission denied: Only admins can change roles"),(0,l.$)(()=>new Error("Permission denied"));const v=(0,a.H9)(this.firestore,"users",t),f=(0,a.mZ)(v,{role:i,updatedAt:(0,h.O5)()}),C=(0,o.Qg)(this.functions,"setCustomUserClaims")({uid:t,claims:this.getRoleClaims(i)});return(0,p.H)(Promise.all([f,C])).pipe((0,g.T)(()=>{}),(0,c.W)(P=>(this.errorService.showError("Failed to update role"),(0,l.$)(()=>new Error(P)))))}))}activateUser(t){return this.validateAdmin().pipe((0,u.n)(()=>{const i=(0,a.H9)(this.firestore,"users",t);return(0,p.H)((0,a.mZ)(i,{isActive:!0,updatedAt:(0,h.O5)()}))}),(0,c.W)(i=>(this.errorService.showError("Failed to activate user"),(0,l.$)(()=>new Error(i)))))}deactivateUser(t){return this.validateAdmin().pipe((0,u.n)(()=>{const i=(0,a.H9)(this.firestore,"users",t);return(0,p.H)((0,a.mZ)(i,{isActive:!1,updatedAt:(0,h.O5)()}))}),(0,c.W)(i=>(this.errorService.showError("Failed to deactivate user"),(0,l.$)(()=>new Error(i)))))}validateAdmin(){return this.authService.profile$.pipe((0,u.n)(t=>t&&"admin"===t.role?(0,D.of)(void 0):(0,l.$)(()=>new Error("Admin privileges required"))))}getRoleClaims(t){return{admin:"admin"===t,author:"author"===t||"admin"===t}}static \u0275fac=function(i){return new(i||e)};static \u0275prov=d.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})()},5734:(U,E,n)=>{n.r(E),n.d(E,{SitemapXmlComponent:()=>A});var d=n(3014),a=n(3107),h=n(4460),o=n(7691),p=n(4466),l=n(3234),D=n(8747),g=n(1540);function c(m,y){const e="object"==typeof y;return new Promise((r,t)=>{const i=new g.Ms({next:s=>{r(s),i.unsubscribe()},error:t,complete:()=>{e?r(y.defaultValue):t(new D.G)}});m.subscribe(i)})}let u=(()=>{class m{blogService=(0,a.WQX)(p.c);http=(0,a.WQX)(o.Qq);baseUrl=l.c.production?"https://blog.beaubuckman.com":"http://localhost:4200";generateSitemapXml(){var e=this;return(0,d.A)(function*(){const r=yield e.collectSitemapUrls();return e.formatXmlSitemap(r)})()}collectSitemapUrls(){var e=this;return(0,d.A)(function*(){return[...e.getStaticUrls(),...yield e.getDynamicUrls()]})()}getStaticUrls(){const e=(new Date).toISOString().split("T")[0];return[{loc:`${this.baseUrl}/`,lastmod:e,changefreq:"daily",priority:1},{loc:`${this.baseUrl}/blog`,lastmod:e,changefreq:"daily",priority:.9},{loc:`${this.baseUrl}/auth/login`,lastmod:e,changefreq:"monthly",priority:.5},{loc:`${this.baseUrl}/auth/signup`,lastmod:e,changefreq:"monthly",priority:.5},{loc:`${this.baseUrl}/legal/privacy-policy`,lastmod:e,changefreq:"yearly",priority:.3},{loc:`${this.baseUrl}/sitemap`,lastmod:e,changefreq:"weekly",priority:.2}]}getDynamicUrls(){var e=this;return(0,d.A)(function*(){try{return(yield e.blogService.getPublishedPosts()).map(t=>{let i;return i=t.updatedAt?(t.updatedAt.toDate?t.updatedAt.toDate():new Date(t.updatedAt)).toISOString().split("T")[0]:t.publishedAt?(t.publishedAt.toDate?t.publishedAt.toDate():new Date(t.publishedAt)).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],{loc:`${e.baseUrl}/blog/${t.id}`,lastmod:i,changefreq:"weekly",priority:.8}})}catch(r){return console.error("Error getting dynamic URLs for sitemap:",r),[]}})()}formatXmlSitemap(e){let r='<?xml version="1.0" encoding="UTF-8"?>\n';return r+='<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n',e.forEach(t=>{r+="  <url>\n",r+=`    <loc>${this.escapeXml(t.loc)}</loc>\n`,t.lastmod&&(r+=`    <lastmod>${t.lastmod}</lastmod>\n`),t.changefreq&&(r+=`    <changefreq>${t.changefreq}</changefreq>\n`),void 0!==t.priority&&(r+=`    <priority>${t.priority.toFixed(1)}</priority>\n`),r+="  </url>\n"}),r+="</urlset>",r}escapeXml(e){return e.replace(/[&<>"']/g,r=>{switch(r){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";default:return r}})}submitSitemapToSearchEngines(){var e=this;return(0,d.A)(function*(){if(!l.c.production)return void console.log("Skipping sitemap submission in development mode");const r=`${e.baseUrl}/sitemap.xml`;try{const t=`https://www.google.com/ping?sitemap=${encodeURIComponent(r)}`;yield c(e.http.get(t)),console.log("Sitemap submitted to Google");const i=`https://www.bing.com/ping?sitemap=${encodeURIComponent(r)}`;yield c(e.http.get(i)),console.log("Sitemap submitted to Bing")}catch(t){console.error("Error submitting sitemap to search engines:",t)}})()}static \u0275fac=function(r){return new(r||m)};static \u0275prov=a.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})(),A=(()=>{class m{sitemapService=(0,a.WQX)(u);xmlContent="";ngOnInit(){this.generateSitemap()}generateSitemap(){var e=this;return(0,d.A)(function*(){try{if(e.xmlContent=yield e.sitemapService.generateSitemapXml(),typeof document<"u"){const r=document.createElement("meta");r.httpEquiv="Content-Type",r.content="application/xml; charset=utf-8",document.head.appendChild(r)}}catch(r){console.error("Error generating sitemap XML:",r),e.xmlContent="\x3c!-- Error generating sitemap --\x3e"}})()}static \u0275fac=function(r){return new(r||m)};static \u0275cmp=a.VBU({type:m,selectors:[["app-sitemap-xml"]],decls:3,vars:1,consts:[[1,"xml-container"]],template:function(r,t){1&r&&(a.j41(0,"div",0)(1,"pre"),a.EFF(2),a.k0s()()),2&r&&(a.R7$(2),a.JRh(t.xmlContent))},dependencies:[h.MD],styles:[".xml-container[_ngcontent-%COMP%]{display:none}"]})}return m})()},6927:(U,E,n)=>{n.d(E,{w:()=>p});var d=n(4460),a=n(7544),h=n(9471),o=n(3107);let p=(()=>{class l{dialogRef;data;constructor(g,c){this.dialogRef=g,this.data=c}static \u0275fac=function(c){return new(c||l)(o.rXU(a.CP),o.rXU(a.Vh))};static \u0275cmp=o.VBU({type:l,selectors:[["app-confirm-dialog"]],decls:10,vars:6,consts:[["mat-dialog-title",""],["align","end"],["mat-button","","mat-dialog-close",""],["mat-raised-button","",3,"color","mat-dialog-close"]],template:function(c,u){1&c&&(o.j41(0,"h2",0),o.EFF(1),o.k0s(),o.j41(2,"mat-dialog-content")(3,"p"),o.EFF(4),o.k0s()(),o.j41(5,"mat-dialog-actions",1)(6,"button",2),o.EFF(7),o.k0s(),o.j41(8,"button",3),o.EFF(9),o.k0s()()),2&c&&(o.R7$(),o.JRh(u.data.title),o.R7$(3),o.JRh(u.data.message),o.R7$(3),o.JRh(u.data.cancelButton||"Cancel"),o.R7$(),o.Y8G("color",u.data.color||"primary")("mat-dialog-close",!0),o.R7$(),o.SpI(" ",u.data.confirmButton||"Confirm"," "))},dependencies:[d.MD,a.hM,a.tx,a.BI,a.E7,a.Yi,h.Hl,h.$z],styles:[".mat-dialog-title[_ngcontent-%COMP%]{margin:0 0 16px}.mat-dialog-content[_ngcontent-%COMP%]{margin:0 0 24px}.mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 0 0}"]})}return l})()}}]);